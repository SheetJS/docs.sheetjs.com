<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-api/parse-options">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-36810333-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>




<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js" async></script><title data-rh="true">Reading Files | SheetJS Community Edition</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.sheetjs.com/docs/api/parse-options"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Reading Files | SheetJS Community Edition"><meta data-rh="true" name="description" content="XLSX.read(data, read_opts) attempts to parse data."><meta data-rh="true" property="og:description" content="XLSX.read(data, read_opts) attempts to parse data."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.sheetjs.com/docs/api/parse-options"><link data-rh="true" rel="alternate" href="https://docs.sheetjs.com/docs/api/parse-options" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.sheetjs.com/docs/api/parse-options" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.a3925cf9.css">
<link rel="preload" href="/assets/js/runtime~main.39ff8733.js" as="script">
<link rel="preload" href="/assets/js/main.0d57be62.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="SheetJS Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="SheetJS Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">SheetJS CE Docs</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://sheetjs.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">SheetJS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/sheetjs/sheetjs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">SheetJS CE</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/installation/">Installation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Installation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/example">Complete Example</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/getting-started/roadmap">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/roadmap">Roadmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/zen">Zen of SheetJS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/getting-started/demos/">Demos</a><button aria-label="Toggle the collapsible sidebar category &#x27;Demos&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/interface">Interface Summary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/solutions/input">Common Use Cases</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/solutions/input">Data Import</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/solutions/processing">Data Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/solutions/output">Data Export</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/csf/general">Common Spreadsheet Format</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/api/parse-options">API Functions</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/api/parse-options">Reading Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/write-options">Writing Files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/utilities">Utility Functions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/miscellany/formats">Miscellany</a></div></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">API Functions</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reading Files</span><meta itemprop="position" content="2"></li></ul></nav><div class="theme-doc-markdown markdown"><h1>Parsing Options</h1><p><code>XLSX.read(data, read_opts)</code> attempts to parse <code>data</code>.</p><p><code>XLSX.readFile(filename, read_opts)</code> attempts to read <code>filename</code> and parse.</p><p>The read functions accept an options argument:</p><table><thead><tr><th align="left">Option Name</th><th align="right">Default</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>type</code></td><td align="right"></td><td align="left">Input data encoding (see Input Type below)</td></tr><tr><td align="left"><code>raw</code></td><td align="right">false</td><td align="left">If true, plain text parsing will not parse values **</td></tr><tr><td align="left"><code>codepage</code></td><td align="right"></td><td align="left">If specified, use code page when appropriate **</td></tr><tr><td align="left"><code>cellFormula</code></td><td align="right">true</td><td align="left">Save formulae to the .f field</td></tr><tr><td align="left"><code>cellHTML</code></td><td align="right">true</td><td align="left">Parse rich text and save HTML to the <code>.h</code> field</td></tr><tr><td align="left"><code>cellNF</code></td><td align="right">false</td><td align="left">Save number format string to the <code>.z</code> field</td></tr><tr><td align="left"><code>cellStyles</code></td><td align="right">false</td><td align="left">Save style/theme info to the <code>.s</code> field</td></tr><tr><td align="left"><code>cellText</code></td><td align="right">true</td><td align="left">Generated formatted text to the <code>.w</code> field</td></tr><tr><td align="left"><code>cellDates</code></td><td align="right">false</td><td align="left">Store dates as type <code>d</code> (default is <code>n</code>)</td></tr><tr><td align="left"><code>dateNF</code></td><td align="right"></td><td align="left">If specified, use the string for date code 14 **</td></tr><tr><td align="left"><code>sheetStubs</code></td><td align="right">false</td><td align="left">Create cell objects of type <code>z</code> for stub cells</td></tr><tr><td align="left"><code>sheetRows</code></td><td align="right">0</td><td align="left">If &gt;0, read the first <code>sheetRows</code> rows **</td></tr><tr><td align="left"><code>bookDeps</code></td><td align="right">false</td><td align="left">If true, parse calculation chains</td></tr><tr><td align="left"><code>bookFiles</code></td><td align="right">false</td><td align="left">If true, add raw files to book object **</td></tr><tr><td align="left"><code>bookProps</code></td><td align="right">false</td><td align="left">If true, only parse enough to get book metadata **</td></tr><tr><td align="left"><code>bookSheets</code></td><td align="right">false</td><td align="left">If true, only parse enough to get the sheet names</td></tr><tr><td align="left"><code>bookVBA</code></td><td align="right">false</td><td align="left">If true, copy VBA blob to <code>vbaraw</code> field **</td></tr><tr><td align="left"><code>password</code></td><td align="right">&quot;&quot;</td><td align="left">If defined and file is encrypted, use password **</td></tr><tr><td align="left"><code>WTF</code></td><td align="right">false</td><td align="left">If true, throw errors on unexpected file features **</td></tr><tr><td align="left"><code>sheets</code></td><td align="right"></td><td align="left">If specified, only parse specified sheets **</td></tr><tr><td align="left"><code>PRN</code></td><td align="right">false</td><td align="left">If true, allow parsing of PRN files **</td></tr><tr><td align="left"><code>xlfn</code></td><td align="right">false</td><td align="left">If true, preserve <code>_xlfn.</code> prefixes in formulae **</td></tr><tr><td align="left"><code>FS</code></td><td align="right"></td><td align="left">DSV Field Separator override</td></tr></tbody></table><ul><li>Even if <code>cellNF</code> is false, formatted text will be generated and saved to <code>.w</code></li><li>In some cases, sheets may be parsed even if <code>bookSheets</code> is false.</li><li>Excel aggressively tries to interpret values from CSV and other plain text.
This leads to surprising behavior! The <code>raw</code> option suppresses value parsing.</li><li><code>bookSheets</code> and <code>bookProps</code> combine to give both sets of information</li><li><code>Deps</code> will be an empty object if <code>bookDeps</code> is false</li><li><code>bookFiles</code> behavior depends on file type:<ul><li><code>keys</code> array (paths in the ZIP) for ZIP-based formats</li><li><code>files</code> hash (mapping paths to objects representing the files) for ZIP</li><li><code>cfb</code> object for formats using CFB containers</li></ul></li><li><code>sheetRows-1</code> rows will be generated when looking at the JSON object output
(since the header row is counted as a row when parsing the data)</li><li>By default all worksheets are parsed.  <code>sheets</code> restricts based on input type:<ul><li>number: zero-based index of worksheet to parse (<code>0</code> is first worksheet)</li><li>string: name of worksheet to parse (case insensitive)</li><li>array of numbers and strings to select multiple worksheets.</li></ul></li><li><code>bookVBA</code> merely exposes the raw VBA CFB object.  It does not parse the data.
XLSM and XLSB store the VBA CFB object in <code>xl/vbaProject.bin</code>. BIFF8 XLS mixes
the VBA entries alongside the core Workbook entry, so the library generates a
new XLSB-compatible blob from the XLS CFB container.</li><li><code>codepage</code> is applied to BIFF2 - BIFF5 files without <code>CodePage</code> records and to
CSV files without BOM in <code>type:&quot;binary&quot;</code>.  BIFF8 XLS always defaults to 1200.</li><li><code>PRN</code> affects parsing of text files without a common delimiter character.</li><li>Currently only XOR encryption is supported.  Unsupported error will be thrown
for files employing other encryption methods.</li><li>Newer Excel functions are serialized with the <code>_xlfn.</code> prefix, hidden from the
user. SheetJS will strip <code>_xlfn.</code> normally. The <code>xlfn</code> option preserves them.</li><li>WTF is mainly for development.  By default, the parser will suppress read
errors on single worksheets, allowing you to read from the worksheets that do
parse properly. Setting <code>WTF:true</code> forces those errors to be thrown.</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="input-type">Input Type<a class="hash-link" href="#input-type" title="Direct link to heading">​</a></h3><p>Strings can be interpreted in multiple ways.  The <code>type</code> parameter for <code>read</code>
tells the library how to parse the data argument:</p><table><thead><tr><th><code>type</code></th><th>expected input</th></tr></thead><tbody><tr><td><code>&quot;base64&quot;</code></td><td>string: Base64 encoding of the file</td></tr><tr><td><code>&quot;binary&quot;</code></td><td>string: binary string (byte <code>n</code> is <code>data.charCodeAt(n)</code>)</td></tr><tr><td><code>&quot;string&quot;</code></td><td>string: JS string (characters interpreted as UTF8)</td></tr><tr><td><code>&quot;buffer&quot;</code></td><td>nodejs Buffer</td></tr><tr><td><code>&quot;array&quot;</code></td><td>array: array of 8-bit unsigned int (byte <code>n</code> is <code>data[n]</code>)</td></tr><tr><td><code>&quot;file&quot;</code></td><td>string: path of file that will be read (nodejs only)</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_mojV" id="guessing-file-type">Guessing File Type<a class="hash-link" href="#guessing-file-type" title="Direct link to heading">​</a></h3><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary><b>Implementation Details</b> (click to show)</summary><div><div class="collapsibleContent_i85q"><p>Excel and other spreadsheet tools read the first few bytes and apply other
heuristics to determine a file type.  This enables file type punning: renaming
files with the <code>.xls</code> extension will tell your computer to use Excel to open the
file but Excel will know how to handle it.  This library applies similar logic:</p><table><thead><tr><th align="left">Byte 0</th><th align="left">Raw File Type</th><th align="left">Spreadsheet Types</th></tr></thead><tbody><tr><td align="left"><code>0xD0</code></td><td align="left">CFB Container</td><td align="left">BIFF 5/8 or protected XLSX/XLSB or WQ3/QPW or XLR</td></tr><tr><td align="left"><code>0x09</code></td><td align="left">BIFF Stream</td><td align="left">BIFF 2/3/4/5</td></tr><tr><td align="left"><code>0x3C</code></td><td align="left">XML/HTML</td><td align="left">SpreadsheetML / Flat ODS / UOS1 / HTML / plain text</td></tr><tr><td align="left"><code>0x50</code></td><td align="left">ZIP Archive</td><td align="left">XLSB or XLSX/M or ODS or UOS2 or NUMBERS or text</td></tr><tr><td align="left"><code>0x49</code></td><td align="left">Plain Text</td><td align="left">SYLK or plain text</td></tr><tr><td align="left"><code>0x54</code></td><td align="left">Plain Text</td><td align="left">DIF or plain text</td></tr><tr><td align="left"><code>0xEF</code></td><td align="left">UTF8 Encoded</td><td align="left">SpreadsheetML / Flat ODS / UOS1 / HTML / plain text</td></tr><tr><td align="left"><code>0xFF</code></td><td align="left">UTF16 Encoded</td><td align="left">SpreadsheetML / Flat ODS / UOS1 / HTML / plain text</td></tr><tr><td align="left"><code>0x00</code></td><td align="left">Record Stream</td><td align="left">Lotus WK<!-- -->*<!-- --> or Quattro Pro or plain text</td></tr><tr><td align="left"><code>0x7B</code></td><td align="left">Plain text</td><td align="left">RTF or plain text</td></tr><tr><td align="left"><code>0x0A</code></td><td align="left">Plain text</td><td align="left">SpreadsheetML / Flat ODS / UOS1 / HTML / plain text</td></tr><tr><td align="left"><code>0x0D</code></td><td align="left">Plain text</td><td align="left">SpreadsheetML / Flat ODS / UOS1 / HTML / plain text</td></tr><tr><td align="left"><code>0x20</code></td><td align="left">Plain text</td><td align="left">SpreadsheetML / Flat ODS / UOS1 / HTML / plain text</td></tr></tbody></table><p>DBF files are detected based on the first byte as well as the third and fourth
bytes (corresponding to month and day of the file date)</p><p>Works for Windows files are detected based on the BOF record with type <code>0xFF</code></p><p>Plain text format guessing follows the priority order:</p><table><thead><tr><th align="left">Format</th><th align="left">Test</th></tr></thead><tbody><tr><td align="left">XML</td><td align="left"><code>&lt;?xml</code> appears in the first 1024 characters</td></tr><tr><td align="left">HTML</td><td align="left">starts with <code>&lt;</code> and HTML tags appear in the first 1024 characters *</td></tr><tr><td align="left">XML</td><td align="left">starts with <code>&lt;</code> and the first tag is valid</td></tr><tr><td align="left">RTF</td><td align="left">starts with <code>{\rt</code></td></tr><tr><td align="left">DSV</td><td align="left">starts with <code>/sep=.$/</code>, separator is the specified character</td></tr><tr><td align="left">DSV</td><td align="left">more unquoted `</td></tr><tr><td align="left">DSV</td><td align="left">more unquoted <code>;</code> chars than <code>\t</code> or <code>,</code> in the first 1024</td></tr><tr><td align="left">TSV</td><td align="left">more unquoted <code>\t</code> chars than <code>,</code> chars in the first 1024</td></tr><tr><td align="left">CSV</td><td align="left">one of the first 1024 characters is a comma <code>&quot;,&quot;</code></td></tr><tr><td align="left">ETH</td><td align="left">starts with <code>socialcalc:version:</code></td></tr><tr><td align="left">PRN</td><td align="left"><code>PRN</code> option is set to true</td></tr><tr><td align="left">CSV</td><td align="left">(fallback)</td></tr></tbody></table><ul><li>HTML tags include: <code>html</code>, <code>table</code>, <code>head</code>, <code>meta</code>, <code>script</code>, <code>style</code>, <code>div</code></li></ul></div></div></details><details class="details_lb9f alert alert--info details_BAp3" data-collapsed="true"><summary><b>Why are random text files valid?</b> (click to show)</summary><div><div class="collapsibleContent_i85q"><p>Excel is extremely aggressive in reading files.  Adding an XLS extension to any
display text file  (where the only characters are ANSI display chars) tricks
Excel into thinking that the file is potentially a CSV or TSV file, even if it
is only one column!  This library attempts to replicate that behavior.</p><p>The best approach is to validate the desired worksheet and ensure it has the
expected number of rows or columns.  Extracting the range is extremely simple:</p><div class="language-js codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-js codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> range </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">XLSX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">decode_range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">worksheet</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;!ref&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ncols </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> range</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">c</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> range</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">c</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> nrows </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> range</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">r</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> range</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">r</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/csf/features/dates"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Dates and Times</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/api/write-options"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Writing Files</div></a></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Intro</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/example">Example</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/sheetjs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://sheetjs.com/pro" target="_blank" rel="noopener noreferrer" class="footer__link-item">SheetJS Pro<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/sheetjs/sheetjs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Source<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 SheetJS LLC.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.39ff8733.js"></script>
<script src="/assets/js/main.0d57be62.js"></script>
</body>
</html>