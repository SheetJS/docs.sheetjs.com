"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5919],{3905:(e,t,a)=>{a.d(t,{Zo:()=>s,kt:()=>h});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var d=n.createContext({}),p=function(e){var t=n.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},s=function(e){var t=p(e.components);return n.createElement(d.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,d=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),k=p(a),h=r,c=k["".concat(d,".").concat(h)]||k[h]||m[h]||l;return a?n.createElement(c,i(i({ref:t},s),{},{components:a})):n.createElement(c,i({ref:t},s))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=k;var o={};for(var d in t)hasOwnProperty.call(t,d)&&(o[d]=t[d]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var p=2;p<l;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},8527:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>m,frontMatter:()=>l,metadata:()=>o,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const l={sidebar_position:3},i="Sheet Objects",o={unversionedId:"csf/sheet",id:"csf/sheet",title:"Sheet Objects",description:'Excel supports 4 different types of "sheets":',source:"@site/docs/07-csf/03-sheet.md",sourceDirName:"07-csf",slug:"/csf/sheet",permalink:"/docs/csf/sheet",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Cell Object",permalink:"/docs/csf/cell"},next:{title:"Workbook Object",permalink:"/docs/csf/book"}},d={},p=[{value:"Generic Sheet Object",id:"generic-sheet-object",level:2},{value:"Sheet Properties",id:"sheet-properties",level:3},{value:"Worksheet Object",id:"worksheet-object",level:2},{value:"Other Sheet Types",id:"other-sheet-types",level:2},{value:"Chartsheet Object",id:"chartsheet-object",level:3},{value:"Macrosheet Object",id:"macrosheet-object",level:3},{value:"Dialogsheet Object",id:"dialogsheet-object",level:3}],s={toc:p};function m(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},s,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"sheet-objects"},"Sheet Objects"),(0,r.kt)("p",null,'Excel supports 4 different types of "sheets":'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'"worksheets": normal sheets'),(0,r.kt)("li",{parentName:"ul"},'"chartsheets": full-tab charts'),(0,r.kt)("li",{parentName:"ul"},'"macrosheets": legacy (pre-VBA) macros'),(0,r.kt)("li",{parentName:"ul"},'"dialogsheets": legacy (pre-VBA) dialogs')),(0,r.kt)("h2",{id:"generic-sheet-object"},"Generic Sheet Object"),(0,r.kt)("p",null,"Generic sheets are plain JavaScript objects.  Each key that does not start with\n",(0,r.kt)("inlineCode",{parentName:"p"},"!")," is an ",(0,r.kt)("inlineCode",{parentName:"p"},"A1"),"-style address whose corresponding value is a cell object."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"sheet[address]")," returns the cell object for the specified address."),(0,r.kt)("h3",{id:"sheet-properties"},"Sheet Properties"),(0,r.kt)("p",null,"Each key starts with ",(0,r.kt)("inlineCode",{parentName:"p"},"!"),".  The properties are accessible as ",(0,r.kt)("inlineCode",{parentName:"p"},"sheet[key]"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"sheet['!ref']"),": A-1 based range representing the sheet range. Functions that\nwork with sheets should use this parameter to determine the range.  Cells that\nare assigned outside of the range are not processed.  In particular, when\nwriting a sheet by hand, cells outside of the range are not included"),(0,r.kt)("p",{parentName:"li"},"Functions that handle sheets should test for the presence of ",(0,r.kt)("inlineCode",{parentName:"p"},"!ref")," field.\nIf the ",(0,r.kt)("inlineCode",{parentName:"p"},"!ref")," is omitted or is not a valid range, functions are free to treat\nthe sheet as empty or attempt to guess the range.  The standard utilities that\nship with this library treat sheets as empty (for example, the CSV output is\nempty string)."),(0,r.kt)("p",{parentName:"li"},"When reading a worksheet with the ",(0,r.kt)("inlineCode",{parentName:"p"},"sheetRows")," property set, the ref parameter\nwill use the restricted range.  The original range is set at ",(0,r.kt)("inlineCode",{parentName:"p"},"ws['!fullref']"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"sheet['!margins']"),': Object representing the page margins.  The default values\nfollow Excel\'s "normal" preset.  Excel also has a "wide" and a "narrow" preset\nbut they are stored as raw measurements. The main properties are listed below:'))),(0,r.kt)("details",null,(0,r.kt)("summary",null,(0,r.kt)("b",null,"Page margin details")," (click to show)"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"key"),(0,r.kt)("th",{parentName:"tr",align:null},"description"),(0,r.kt)("th",{parentName:"tr",align:"left"},'"normal"'),(0,r.kt)("th",{parentName:"tr",align:"left"},'"wide"'),(0,r.kt)("th",{parentName:"tr",align:"left"},'"narrow"'))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"left")),(0,r.kt)("td",{parentName:"tr",align:null},"left margin (inches)"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.7")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"1.0")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.25"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"right")),(0,r.kt)("td",{parentName:"tr",align:null},"right margin (inches)"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.7")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"1.0")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.25"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"top")),(0,r.kt)("td",{parentName:"tr",align:null},"top margin (inches)"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.75")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"1.0")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.75"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"bottom")),(0,r.kt)("td",{parentName:"tr",align:null},"bottom margin (inches)"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.75")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"1.0")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.75"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"header")),(0,r.kt)("td",{parentName:"tr",align:null},"header margin (inches)"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.3")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.5")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.3"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"footer")),(0,r.kt)("td",{parentName:"tr",align:null},"footer margin (inches)"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.3")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.5")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"0.3"))))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'/* Set worksheet sheet to "normal" */\nws["!margins"]={left:0.7, right:0.7, top:0.75,bottom:0.75,header:0.3,footer:0.3}\n/* Set worksheet sheet to "wide" */\nws["!margins"]={left:1.0, right:1.0, top:1.0, bottom:1.0, header:0.5,footer:0.5}\n/* Set worksheet sheet to "narrow" */\nws["!margins"]={left:0.25,right:0.25,top:0.75,bottom:0.75,header:0.3,footer:0.3}\n'))),(0,r.kt)("h2",{id:"worksheet-object"},"Worksheet Object"),(0,r.kt)("p",null,"In addition to the aforementioned sheet keys, worksheets also add:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"ws['!cols']"),': array of column properties objects.  Column widths are actually\nstored in files in a normalized manner, measured in terms of the "Maximum\nDigit Width" (the largest width of the rendered digits 0-9, in pixels).  When\nparsed, the column objects store the pixel width in the ',(0,r.kt)("inlineCode",{parentName:"p"},"wpx")," field, character\nwidth in the ",(0,r.kt)("inlineCode",{parentName:"p"},"wch")," field, and the maximum digit width in the ",(0,r.kt)("inlineCode",{parentName:"p"},"MDW")," field.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"ws['!rows']"),": array of row properties objects as explained later in the docs.\nEach row object encodes properties including row height and visibility.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"ws['!merges']"),": array of range objects corresponding to the merged cells in\nthe worksheet.  Plain text formats do not support merge cells.  CSV export\nwill write all cells in the merge range if they exist, so be sure that only\nthe first cell (upper-left) in the range is set.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"ws['!outline']"),": configure how outlines should behave.  Options default to\nthe default settings in Excel 2019:"))),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"key"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Excel feature"),(0,r.kt)("th",{parentName:"tr",align:"left"},"default"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"above")),(0,r.kt)("td",{parentName:"tr",align:"left"},'Disable "Summary rows below detail"'),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"false"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"left")),(0,r.kt)("td",{parentName:"tr",align:"left"},'Disable "Summary rows to the right of detail"'),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"false"))))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ws['!protect']"),": object of write sheet protection properties.  The ",(0,r.kt)("inlineCode",{parentName:"li"},"password"),"\nkey specifies the password for formats that support password-protected sheets\n(XLSX/XLSB/XLS).  The writer uses the XOR obfuscation method.  The following\nkeys control the sheet protection -- set to ",(0,r.kt)("inlineCode",{parentName:"li"},"false")," to enable a feature when\nsheet is locked or set to ",(0,r.kt)("inlineCode",{parentName:"li"},"true")," to disable a feature:")),(0,r.kt)("details",null,(0,r.kt)("summary",null,(0,r.kt)("b",null,"Worksheet Protection Details")," (click to show)"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"key"),(0,r.kt)("th",{parentName:"tr",align:"left"},"feature (true=disabled / false=enabled)"),(0,r.kt)("th",{parentName:"tr",align:"left"},"default"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"selectLockedCells")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Select locked cells"),(0,r.kt)("td",{parentName:"tr",align:"left"},"enabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"selectUnlockedCells")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Select unlocked cells"),(0,r.kt)("td",{parentName:"tr",align:"left"},"enabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"formatCells")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Format cells"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"formatColumns")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Format columns"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"formatRows")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Format rows"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"insertColumns")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Insert columns"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"insertRows")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Insert rows"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"insertHyperlinks")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Insert hyperlinks"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"deleteColumns")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Delete columns"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"deleteRows")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Delete rows"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"sort")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Sort"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"autoFilter")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Filter"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pivotTables")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Use PivotTable reports"),(0,r.kt)("td",{parentName:"tr",align:"left"},"disabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"objects")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Edit objects"),(0,r.kt)("td",{parentName:"tr",align:"left"},"enabled")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"scenarios")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Edit scenarios"),(0,r.kt)("td",{parentName:"tr",align:"left"},"enabled"))))),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ws['!autofilter']"),": AutoFilter object following the schema:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"type AutoFilter = {\n  ref:string; // A-1 based range representing the AutoFilter table range\n}\n")),(0,r.kt)("h2",{id:"other-sheet-types"},"Other Sheet Types"),(0,r.kt)("h3",{id:"chartsheet-object"},"Chartsheet Object"),(0,r.kt)("p",null,"Chartsheets are represented as standard sheets.  They are distinguished with the\n",(0,r.kt)("inlineCode",{parentName:"p"},"!type")," property set to ",(0,r.kt)("inlineCode",{parentName:"p"},'"chart"'),"."),(0,r.kt)("p",null,"The underlying data and ",(0,r.kt)("inlineCode",{parentName:"p"},"!ref")," refer to the cached data in the chartsheet.  The\nfirst row of the chartsheet is the underlying header."),(0,r.kt)("h3",{id:"macrosheet-object"},"Macrosheet Object"),(0,r.kt)("p",null,"Macrosheets are represented as standard sheets.  They are distinguished with the\n",(0,r.kt)("inlineCode",{parentName:"p"},"!type")," property set to ",(0,r.kt)("inlineCode",{parentName:"p"},'"macro"'),"."),(0,r.kt)("h3",{id:"dialogsheet-object"},"Dialogsheet Object"),(0,r.kt)("p",null,"Dialogsheets are represented as standard sheets. They are distinguished with the\n",(0,r.kt)("inlineCode",{parentName:"p"},"!type")," property set to ",(0,r.kt)("inlineCode",{parentName:"p"},'"dialog"'),"."))}m.isMDXComponent=!0}}]);