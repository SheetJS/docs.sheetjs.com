"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7879],{9613:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(9496);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=d(n),m=r,f=u["".concat(l,".").concat(m)]||u[m]||c[m]||o;return n?a.createElement(f,i(i({ref:t},p),{},{components:n})):a.createElement(f,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},854:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return s},metadata:function(){return d},toc:function(){return c}});var a=n(2848),r=n(9213),o=(n(9496),n(9613)),i=["components"],s={sidebar_position:12,title:"Legacy Frameworks"},l=void 0,d={unversionedId:"getting-started/demos/legacy",id:"getting-started/demos/legacy",title:"Legacy Frameworks",description:"Over the years, many frameworks have been released. Some were popular years ago",source:"@site/docs/04-getting-started/03-demos/12-legacy.md",sourceDirName:"04-getting-started/03-demos",slug:"/getting-started/demos/legacy",permalink:"/docs/getting-started/demos/legacy",draft:!1,tags:[],version:"current",sidebarPosition:12,frontMatter:{sidebar_position:12,title:"Legacy Frameworks"},sidebar:"tutorialSidebar",previous:{title:"NoSQL Data Stores",permalink:"/docs/getting-started/demos/nosql"},next:{title:"Interface Summary",permalink:"/docs/interface"}},p={},c=[{value:"Integration",id:"integration",level:2},{value:"Frameworks",id:"frameworks",level:2},{value:"KnockoutJS",id:"knockoutjs",level:3},{value:"State",id:"state",level:4},{value:"Data Binding",id:"data-binding",level:4}],u={toc:c};function m(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Over the years, many frameworks have been released. Some were popular years ago\nbut have waned in recent years. There are still many deployments using these\nframeworks and it is oftentimes esasier to continue maintenance than to rewrite\nusing modern web techniques."),(0,o.kt)("p",null,"SheetJS libraries strive to maintain broad browser and JS engine compatibility."),(0,o.kt)("h2",{id:"integration"},"Integration"),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"../../installation/standalone"},'"Standalone Browser Scripts"')," section has\ninstructions for obtaining or referencing the standalone scripts.  These are\ndesigned to be referenced with ",(0,o.kt)("inlineCode",{parentName:"p"},"<script>")," tags."),(0,o.kt)("h2",{id:"frameworks"},"Frameworks"),(0,o.kt)("h3",{id:"knockoutjs"},"KnockoutJS"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Knockout_(web_framework)"},"KnockoutJS")," was a\npopular MVVM framework."),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"pathname:///knockout/knockout.html"},"Live demo")," shows a view model that is\nupdated with file data and exported to spreadsheets."),(0,o.kt)("h4",{id:"state"},"State"),(0,o.kt)("p",null,"Arrays of arrays are the simplest data structure for representing worksheets."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"var aoa = [\n  [1, 2], // A1 = 1, B1 = 2\n  [3, 4]  // A1 = 3, B1 = 4\n];\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ko.observableArray")," should be used to create the view model:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"function ViewModel() {\n  /* use an array of arrays */\n  this.aoa = ko.observableArray([ [1,2], [3,4] ]);\n}\n/* create model */\nvar model = new ViewModel();\nko.applyBindings(model);\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"XLSX.utils.sheet_to_json")," with ",(0,o.kt)("inlineCode",{parentName:"p"},"header: 1")," generates data for the model:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"/* starting from a `wb` workbook object, pull first worksheet */\nvar ws = wb.Sheets[wb.SheetNames[0]];\n/* convert the worksheet to an array of arrays */\nvar aoa = XLSX.utils.sheet_to_json(ws, {header:1});\n/* update model */\nmodel.aoa(aoa);\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"XLSX.utils.aoa_to_sheet")," generates worksheets from the model:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"var aoa = model.aoa();\nvar ws = XLSX.utils.aoa_to_sheet(aoa);\n")),(0,o.kt)("h4",{id:"data-binding"},"Data Binding"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},'data-bind="foreach: ..."')," provides a simple approach for binding to ",(0,o.kt)("inlineCode",{parentName:"p"},"TABLE"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<table data-bind="foreach: aoa">\n  <tr data-bind="foreach: $data">\n    <td><span data-bind="text: $data"></span></td>\n  </tr>\n</table>\n')),(0,o.kt)("p",null,"Unfortunately the nested ",(0,o.kt)("inlineCode",{parentName:"p"},'"foreach: $data"')," binding is read-only.  A two-way\nbinding is possible using the ",(0,o.kt)("inlineCode",{parentName:"p"},"$parent")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"$index")," binding context properties:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<table data-bind="foreach: aoa">\n  <tr data-bind="foreach: $data">\n    <td><input data-bind="value: $parent[$index()]" /></td>\n  </tr>\n</table>\n')))}m.isMDXComponent=!0}}]);