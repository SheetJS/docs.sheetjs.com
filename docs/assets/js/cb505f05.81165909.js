"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6090],{9613:function(e,n,a){a.d(n,{Zo:function(){return u},kt:function(){return g}});var t=a(9496);function l(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function r(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function s(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?r(Object(a),!0).forEach((function(n){l(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function o(e,n){if(null==e)return{};var a,t,l=function(e,n){if(null==e)return{};var a,t,l={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||(l[a]=e[a]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var i=t.createContext({}),p=function(e){var n=t.useContext(i),a=n;return e&&(a="function"==typeof e?e(n):s(s({},n),e)),a},u=function(e){var n=p(e.components);return t.createElement(i.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},c=t.forwardRef((function(e,n){var a=e.components,l=e.mdxType,r=e.originalType,i=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),c=p(a),g=l,d=c["".concat(i,".").concat(g)]||c[g]||m[g]||r;return a?t.createElement(d,s(s({ref:n},u),{},{components:a})):t.createElement(d,s({ref:n},u))}));function g(e,n){var a=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var r=a.length,s=new Array(r);s[0]=c;var o={};for(var i in n)hasOwnProperty.call(n,i)&&(o[i]=n[i]);o.originalType=e,o.mdxType="string"==typeof e?e:l,s[1]=o;for(var p=2;p<r;p++)s[p]=a[p];return t.createElement.apply(null,s)}return t.createElement.apply(null,a)}c.displayName="MDXCreateElement"},8264:function(e,n,a){a.d(n,{Z:function(){return s}});var t=a(9496),l=a(1626),r="tabItem_ZP9l";function s(e){var n=e.children,a=e.hidden,s=e.className;return t.createElement("div",{role:"tabpanel",className:(0,l.Z)(r,s),hidden:a},n)}},114:function(e,n,a){a.d(n,{Z:function(){return g}});var t=a(2848),l=a(9496),r=a(3026),s=a(8658),o=a(1823),i=a(4807),p=a(1626),u="tabList_XleC",m="tabItem_hpFr";function c(e){var n,a,r,c=e.lazy,g=e.block,d=e.defaultValue,h=e.values,k=e.groupId,f=e.className,v=l.Children.map(e.children,(function(e){if((0,l.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),N=null!=h?h:v.map((function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes}})),b=(0,s.l)(N,(function(e,n){return e.value===n.value}));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var j=null===d?d:null!=(n=null!=d?d:null==(a=v.find((function(e){return e.props.default})))?void 0:a.props.value)?n:null==(r=v[0])?void 0:r.props.value;if(null!==j&&!N.some((function(e){return e.value===j})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+j+'" but none of its children has the corresponding value. Available values are: '+N.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var y=(0,o.U)(),w=y.tabGroupChoices,C=y.setTabGroupChoices,S=(0,l.useState)(j),T=S[0],x=S[1],L=[],A=(0,i.o5)().blockElementScrollPositionUntilNextRender;if(null!=k){var I=w[k];null!=I&&I!==T&&N.some((function(e){return e.value===I}))&&x(I)}var O=function(e){var n=e.currentTarget,a=L.indexOf(n),t=N[a].value;t!==T&&(A(n),x(t),null!=k&&C(k,t))},_=function(e){var n,a=null;switch(e.key){case"ArrowRight":var t=L.indexOf(e.currentTarget)+1;a=L[t]||L[0];break;case"ArrowLeft":var l=L.indexOf(e.currentTarget)-1;a=L[l]||L[L.length-1]}null==(n=a)||n.focus()};return l.createElement("div",{className:(0,p.Z)("tabs-container",u)},l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,p.Z)("tabs",{"tabs--block":g},f)},N.map((function(e){var n=e.value,a=e.label,r=e.attributes;return l.createElement("li",(0,t.Z)({role:"tab",tabIndex:T===n?0:-1,"aria-selected":T===n,key:n,ref:function(e){return L.push(e)},onKeyDown:_,onFocus:O,onClick:O},r,{className:(0,p.Z)("tabs__item",m,null==r?void 0:r.className,{"tabs__item--active":T===n})}),null!=a?a:n)}))),c?(0,l.cloneElement)(v.filter((function(e){return e.props.value===T}))[0],{className:"margin-top--md"}):l.createElement("div",{className:"margin-top--md"},v.map((function(e,n){return(0,l.cloneElement)(e,{key:n,hidden:e.props.value!==T})}))))}function g(e){var n=(0,r.Z)();return l.createElement(c,(0,t.Z)({key:String(n)},e))}},4996:function(e,n,a){a.r(n),a.d(n,{assets:function(){return c},contentTitle:function(){return u},default:function(){return h},frontMatter:function(){return p},metadata:function(){return m},toc:function(){return g}});var t=a(2848),l=a(9213),r=(a(9496),a(9613)),s=a(114),o=a(8264),i=["components"],p={sidebar_position:23,title:"Angular"},u=void 0,m={unversionedId:"demos/angular",id:"demos/angular",title:"Angular",description:"Angular is a JS library for building user interfaces.",source:"@site/docs/03-demos/23-angular.md",sourceDirName:"03-demos",slug:"/demos/angular",permalink:"/docs/demos/angular",draft:!1,tags:[],version:"current",sidebarPosition:23,frontMatter:{sidebar_position:23,title:"Angular"},sidebar:"tutorialSidebar",previous:{title:"VueJS",permalink:"/docs/demos/vue"},next:{title:"HTTP Server Processing",permalink:"/docs/demos/server"}},c={},g=[{value:"Installation",id:"installation",level:2},{value:"Internal State",id:"internal-state",level:2},{value:"Array of Objects",id:"array-of-objects",level:3},{value:"HTML",id:"html",level:3},{value:"Rows and Columns",id:"rows-and-columns",level:3},{value:"Older Versions",id:"older-versions",level:2},{value:"Strategies",id:"strategies",level:3},{value:"Internal State",id:"internal-state-1",level:4},{value:"Reading Data",id:"reading-data",level:4},{value:"Writing Data",id:"writing-data",level:4},{value:"SystemJS",id:"systemjs",level:3},{value:"Legacy Demo",id:"legacy-demo",level:3}],d={toc:g};function h(e){var n=e.components,a=(0,l.Z)(e,i);return(0,r.kt)("wrapper",(0,t.Z)({},d,a,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://angular.io/"},"Angular")," is a JS library for building user interfaces."),(0,r.kt)("p",null,"This demo tries to cover common Angular data flow ideas and strategies. Angular\nand TypeScript familiarity is assumed."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"SheetJS plays nice with each version of Angular"),"."),(0,r.kt)("p",null,"Other demos cover general Angular deployments, including:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"./mobile#nativescript"},"iOS and Android applications powered by NativeScript")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"./mobile#ionic"},"iOS and Android applications powered by ionic"))),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Angular dev tooling uses native NodeJS modules. There are a number of issues\nwhen trying to run Angular projects with different NodeJS versions. These\nissues should be directed to the Angular project."))),(0,r.kt)("h2",{id:"installation"},"Installation"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"../getting-started/installation/frameworks"},'The "Frameworks" section')," covers\ninstallation with ",(0,r.kt)("inlineCode",{parentName:"p"},"pnpm")," and other package managers."),(0,r.kt)("p",null,"The library can be imported directly from JS or TS code with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import { read, utils, writeFile } from 'xlsx';\n")),(0,r.kt)("h2",{id:"internal-state"},"Internal State"),(0,r.kt)("p",null,"The various SheetJS APIs work with various data shapes.  The preferred state\ndepends on the application."),(0,r.kt)("h3",{id:"array-of-objects"},"Array of Objects"),(0,r.kt)("p",null,"Typically, some users will create a spreadsheet with source data that should be\nloaded into the site.  This sheet will have known columns.  For example, our\n",(0,r.kt)("a",{parentName:"p",href:"https://sheetjs.com/pres.xlsx"},"presidents sheet"),' has "Name" / "Index" columns:'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"/pres.png",alt:"`pres.xlsx` data"})),(0,r.kt)("p",null,"This naturally maps to an array of typed objects, as in the TS example below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"import { read, utils } from 'xlsx';\n\ninterface President {\n  Name: string;\n  Index: number;\n}\n\nconst f = await (await fetch(\"https://sheetjs.com/pres.xlsx\")).arrayBuffer();\nconst wb = read(f);\nconst data = utils.sheet_to_json<President>(wb.Sheets[wb.SheetNames[0]]);\nconsole.log(data);\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"data")," will be an array of objects:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'[\n  { Name: "Bill Clinton", Index: 42 },\n  { Name: "GeorgeW Bush", Index: 43 },\n  { Name: "Barack Obama", Index: 44 },\n  { Name: "Donald Trump", Index: 45 },\n  { Name: "Joseph Biden", Index: 46 }\n]\n')),(0,r.kt)("p",null,"A component will typically loop over the data using ",(0,r.kt)("inlineCode",{parentName:"p"},"*ngFor"),". The following\nexample generates a TABLE with a row for each President:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="src/app/app.component.ts"',title:'"src/app/app.component.ts"'},'import { Component } from \'@angular/core\';\nimport { read, utils, writeFileXLSX } from \'xlsx\';\n\ninterface President { Name: string; Index: number };\n\n@Component({\n  selector: \'app-root\',\n  template: `\n<div class="content" role="main"><table>\n  <thead><th>Name</th><th>Index</th></thead>\n  <tbody>\n// highlight-start\n    <tr *ngFor="let row of rows">\n      <td>{{row.Name}}</td>\n      <td>{{row.Index}}</td>\n    </tr>\n// highlight-end\n  </tbody><tfoot>\n    <button (click)="onSave()">Export XLSX</button>\n  </tfoot>\n</table></div>\n`\n})\nexport class AppComponent {\n  // highlight-next-line\n  rows: President[] = [ { Name: "SheetJS", Index: 0 }];\n  ngOnInit(): void { (async() => {\n    /* Download from https://sheetjs.com/pres.numbers */\n    const f = await fetch("https://sheetjs.com/pres.numbers");\n    const ab = await f.arrayBuffer();\n\n    /* parse workbook */\n    // highlight-next-line\n    const wb = read(ab);\n\n    /* update data */\n    // highlight-next-line\n    this.rows = utils.sheet_to_json<President>(wb.Sheets[wb.SheetNames[0]]);\n\n  })(); }\n  /* get state data and export to XLSX */\n  onSave(): void {\n    // highlight-next-line\n    const ws = utils.json_to_sheet(this.rows);\n    const wb = utils.book_new();\n    utils.book_append_sheet(wb, ws, "Data");\n    writeFileXLSX(wb, "SheetJSAngularAoO.xlsx");\n  }\n}\n')),(0,r.kt)("h3",{id:"html"},"HTML"),(0,r.kt)("p",null,"The main disadvantage of the Array of Objects approach is the specific nature\nof the columns.  For more general use, passing around an Array of Arrays works.\nHowever, this does not handle merge cells well!"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"sheet_to_html")," function generates HTML that is aware of merges and other\nworksheet features.  The generated HTML does not contain any ",(0,r.kt)("inlineCode",{parentName:"p"},"<script>")," tags,\nand should therefore be safe to pass to an ",(0,r.kt)("inlineCode",{parentName:"p"},"innerHTML"),"-bound variable, but the\n",(0,r.kt)("inlineCode",{parentName:"p"},"DomSanitizer")," approach is strongly recommended:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="src/app/app.component.ts"',title:'"src/app/app.component.ts"'},'import { Component, ElementRef, ViewChild } from \'@angular/core\';\n// highlight-next-line\nimport { DomSanitizer, SafeHtml } from \'@angular/platform-browser\';\nimport { read, utils, writeFileXLSX } from \'xlsx\';\n\n@Component({\n  selector: \'app-root\',\n// highlight-next-line\n  template: `<div class="content" role="main" [innerHTML]="html" #tableau></div>\n    <button (click)="onSave()">Export XLSX</button>`\n})\nexport class AppComponent {\n  // highlight-start\n  constructor(private sanitizer: DomSanitizer) {}\n  html: SafeHtml = "";\n  @ViewChild(\'tableau\') tabeller!: ElementRef<HTMLDivElement>;\n  // highlight-end\n  ngOnInit(): void { (async() => {\n    /* Download from https://sheetjs.com/pres.numbers */\n    const f = await fetch("https://sheetjs.com/pres.numbers");\n    const ab = await f.arrayBuffer();\n\n    /* parse workbook */\n    const wb = read(ab);\n\n    /* update data */\n    // highlight-start\n    const h = utils.sheet_to_html(wb.Sheets[wb.SheetNames[0]]);\n    this.html = this.sanitizer.bypassSecurityTrustHtml(h);\n    // highlight-end\n  })(); }\n  /* get live table and export to XLSX */\n  onSave(): void {\n    // highlight-start\n    const elt = this.tabeller.nativeElement.getElementsByTagName("TABLE")[0];\n    const wb = utils.table_to_book(elt);\n    // highlight-end\n    writeFileXLSX(wb, "SheetJSAngularHTML.xlsx");\n  }\n}\n')),(0,r.kt)("h3",{id:"rows-and-columns"},"Rows and Columns"),(0,r.kt)("p",null,"Some data grids and UI components split worksheet state in two parts: an array\nof column attribute objects and an array of row objects.  The former is used to\ngenerate column headings and for indexing into the row objects."),(0,r.kt)("p",null,"The safest approach is to use an array of arrays for state and to generate\ncolumn objects that map to A1-Style column headers."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"ngx-datatable")," uses ",(0,r.kt)("inlineCode",{parentName:"p"},"prop")," as the key and ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," for the column label:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'/* rows are generated with a simple array of arrays */\nthis.rows = utils.sheet_to_json(worksheet, { header: 1 });\n\n/* column objects are generated based on the worksheet range */\nconst range = utils.decode_range(ws["!ref"]||"A1");\nthis.columns = Array.from({ length: range.e.c + 1 }, (_, i) => ({\n  /* for an array of arrays, the keys are "0", "1", "2", ... */\n  prop: String(i),\n  /* column labels: encode_col translates 0 -> "A", 1 -> "B", 2 -> "C", ... */\n  name: XLSX.utils.encode_col(i)\n}));\n')),(0,r.kt)("h2",{id:"older-versions"},"Older Versions"),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"This demo is included for legacy deployments. There are incompatibilities with\ndifferent NodeJS and other ecosystem versions.  Issues should be raised with\nGoogle and the Angular team."),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("strong",{parentName:"p"},"The newest versions of NodeJS will not work with older Angular projects!")))),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The Angular tooling provides no easy way to switch between versions!"),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("a",{parentName:"p",href:"https://github.com/angular/angular-cli/issues/9047"},"This is a known Angular problem")),(0,r.kt)("p",{parentName:"div"},"To work around this, ",(0,r.kt)("a",{parentName:"p",href:"pathname:///angular/SheetJSAngular.zip"},(0,r.kt)("inlineCode",{parentName:"a"},"SheetJSAngular.zip")),"\nis a skeleton project designed to play nice with each Angular version."))),(0,r.kt)("h3",{id:"strategies"},"Strategies"),(0,r.kt)("h4",{id:"internal-state-1"},"Internal State"),(0,r.kt)("p",null,"This demo uses an array of arrays as the internal state:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"export class SheetJSComponent {\n  data: any[][] = [ [1, 2], [3, 4] ];\n  // ...\n}\n")),(0,r.kt)("p",null,"Nested ",(0,r.kt)("inlineCode",{parentName:"p"},"ngFor")," in a template can loop across the rows and cells:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<table class="sjs-table">\n  <tr *ngFor="let row of data">\n    <td *ngFor="let val of row">{{val}}</td>\n  </tr>\n</table>\n')),(0,r.kt)("h4",{id:"reading-data"},"Reading Data"),(0,r.kt)("p",null,"For legacy deployments, the best ingress is a standard HTML INPUT file element:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<input type="file" (change)="onFileChange($event)" multiple="false" />\n')),(0,r.kt)("p",null,"In the component, the event is a standard file event.  Using a ",(0,r.kt)("inlineCode",{parentName:"p"},"FileReader")," has\nbroad support compared to the modern ",(0,r.kt)("inlineCode",{parentName:"p"},"Blob#arrayBuffer")," approach:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"  onFileChange(evt: any) {\n    /* wire up file reader */\n    const target: DataTransfer = <DataTransfer>(evt.target);\n    if (target.files.length !== 1) throw new Error('Cannot use multiple files');\n    const reader: FileReader = new FileReader();\n    reader.onload = (e: any) => {\n      /* read workbook */\n      const ab: ArrayBuffer = e.target.result;\n      // highlight-next-line\n      const wb: WorkBook = read(ab);\n\n      /* grab first sheet */\n      const wsname: string = wb.SheetNames[0];\n      const ws: WorkSheet = wb.Sheets[wsname];\n\n      /* save data */\n      // highlight-next-line\n      this.data = <AOA>(utils.sheet_to_json(ws, {header: 1}));\n    };\n    reader.readAsArrayBuffer(target.files[0]);\n  }\n")),(0,r.kt)("h4",{id:"writing-data"},"Writing Data"),(0,r.kt)("p",null,"The demo uses an HTML5 button in the template:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<button (click)="export()">Export!</button>\n')),(0,r.kt)("p",null,"In the component, ",(0,r.kt)("inlineCode",{parentName:"p"},"aoa_to_sheet")," is used to generate the worksheet:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"  export(): void {\n    /* generate worksheet */\n    const ws: WorkSheet = utils.aoa_to_sheet(this.data);\n\n    /* generate workbook and add the worksheet */\n    const wb: WorkBook = utils.book_new();\n    utils.book_append_sheet(wb, ws, 'Sheet1');\n\n    /* save to file */\n    writeFile(wb, \"SheetJS.xlsx\");\n  }\n")),(0,r.kt)("h3",{id:"systemjs"},"SystemJS"),(0,r.kt)("p",null,"The default angular-cli configuration requires no additional configuration."),(0,r.kt)("p",null,"Some deployments use the SystemJS loader, which does require configuration.\n",(0,r.kt)("a",{parentName:"p",href:"./bundler#systemjs"},"The SystemJS demo")," describe the required settings."),(0,r.kt)("h3",{id:"legacy-demo"},"Legacy Demo"),(0,r.kt)("p",null,"0) Download and unzip ",(0,r.kt)("a",{parentName:"p",href:"pathname:///angular/SheetJSAngular.zip"},(0,r.kt)("inlineCode",{parentName:"a"},"SheetJSAngular.zip")),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -LO https://docs.sheetjs.com/angular/SheetJSAngular.zip\nunzip SheetJSAngular.zip\ncd SheetJSAngular\n")),(0,r.kt)("p",null,"1) Download the files for the desired Angular version:"),(0,r.kt)(s.Z,{mdxType:"Tabs"},(0,r.kt)(o.Z,{value:"2",label:"2",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng2"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng2"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng2"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng2"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng2\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng2\n"))),(0,r.kt)(o.Z,{value:"4",label:"4",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng4"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng4"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng4"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng4"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng4\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng4\n"))),(0,r.kt)(o.Z,{value:"5",label:"5",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng5"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng5"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng5"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng5"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng5\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng5\n"))),(0,r.kt)(o.Z,{value:"6",label:"6",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng6"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng6"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng6"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng6"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/angular.json-ng6"},(0,r.kt)("inlineCode",{parentName:"a"},"angular.json-ng6"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"angular.json"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng6\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng6\ncurl -o angular.json -L https://docs.sheetjs.com/angular/versions/angular.json-ng6\n"))),(0,r.kt)(o.Z,{value:"7",label:"7",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng7"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng7"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng7"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng7"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/angular.json-ng7"},(0,r.kt)("inlineCode",{parentName:"a"},"angular.json-ng7"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"angular.json"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng7\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng7\ncurl -o angular.json -L https://docs.sheetjs.com/angular/versions/angular.json-ng7\n"))),(0,r.kt)(o.Z,{value:"8",label:"8",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng8"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng8"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng8"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng8"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/angular.json-ng8"},(0,r.kt)("inlineCode",{parentName:"a"},"angular.json-ng8"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"angular.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/tsconfig.app.json-ng8"},(0,r.kt)("inlineCode",{parentName:"a"},"tsconfig.app.json-ng8"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"tsconfig.app.json"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng8\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng8\ncurl -o angular.json -L https://docs.sheetjs.com/angular/versions/angular.json-ng8\ncurl -o tsconfig.app.json -L https://docs.sheetjs.com/angular/versions/tsconfig.app.json-ng8\n"))),(0,r.kt)(o.Z,{value:"9",label:"9",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng9"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng9"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng9"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng9"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/angular.json-ng9"},(0,r.kt)("inlineCode",{parentName:"a"},"angular.json-ng9"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"angular.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/tsconfig.app.json-ng9"},(0,r.kt)("inlineCode",{parentName:"a"},"tsconfig.app.json-ng9"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"tsconfig.app.json"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng9\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng9\ncurl -o angular.json -L https://docs.sheetjs.com/angular/versions/angular.json-ng9\ncurl -o tsconfig.app.json -L https://docs.sheetjs.com/angular/versions/tsconfig.app.json-ng9\n"))),(0,r.kt)(o.Z,{value:"10",label:"10",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng10"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng10"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng10"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng10"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/angular.json-ng10"},(0,r.kt)("inlineCode",{parentName:"a"},"angular.json-ng10"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"angular.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/tsconfig.app.json-ng10"},(0,r.kt)("inlineCode",{parentName:"a"},"tsconfig.app.json-ng10"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"tsconfig.app.json"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng10\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng10\ncurl -o angular.json -L https://docs.sheetjs.com/angular/versions/angular.json-ng10\ncurl -o tsconfig.app.json -L https://docs.sheetjs.com/angular/versions/tsconfig.app.json-ng10\n"))),(0,r.kt)(o.Z,{value:"11",label:"11",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng11"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng11"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng11"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng11"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/angular.json-ng11"},(0,r.kt)("inlineCode",{parentName:"a"},"angular.json-ng11"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"angular.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/tsconfig.app.json-ng11"},(0,r.kt)("inlineCode",{parentName:"a"},"tsconfig.app.json-ng11"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"tsconfig.app.json"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng11\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng11\ncurl -o angular.json -L https://docs.sheetjs.com/angular/versions/angular.json-ng11\ncurl -o tsconfig.app.json -L https://docs.sheetjs.com/angular/versions/tsconfig.app.json-ng11\n"))),(0,r.kt)(o.Z,{value:"12",label:"12",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng12"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng12"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng12"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng12"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/angular.json-ng12"},(0,r.kt)("inlineCode",{parentName:"a"},"angular.json-ng12"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"angular.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/tsconfig.app.json-ng12"},(0,r.kt)("inlineCode",{parentName:"a"},"tsconfig.app.json-ng12"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"tsconfig.app.json"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng12\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng12\ncurl -o angular.json -L https://docs.sheetjs.com/angular/versions/angular.json-ng12\ncurl -o tsconfig.app.json -L https://docs.sheetjs.com/angular/versions/tsconfig.app.json-ng12\n"))),(0,r.kt)(o.Z,{value:"13",label:"13",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/package.json-ng13"},(0,r.kt)("inlineCode",{parentName:"a"},"package.json.ng13"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"package.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/polyfills.ts-ng13"},(0,r.kt)("inlineCode",{parentName:"a"},"polyfills.ts-ng13"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"src/polyfills.ts")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/angular.json-ng13"},(0,r.kt)("inlineCode",{parentName:"a"},"angular.json-ng13"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"angular.json")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"pathname:///angular/versions/tsconfig.app.json-ng13"},(0,r.kt)("inlineCode",{parentName:"a"},"tsconfig.app.json-ng13"))," save to ",(0,r.kt)("inlineCode",{parentName:"li"},"tsconfig.app.json"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -o package.json -L https://docs.sheetjs.com/angular/versions/package.json-ng13\ncurl -o src/polyfills.ts -L https://docs.sheetjs.com/angular/versions/polyfills.ts-ng13\ncurl -o angular.json -L https://docs.sheetjs.com/angular/versions/angular.json-ng13\ncurl -o tsconfig.app.json -L https://docs.sheetjs.com/angular/versions/tsconfig.app.json-ng13\n")))),(0,r.kt)("p",null,"2) install project and dependencies:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm i\nnpm i -S https://cdn.sheetjs.com/xlsx-latest/xlsx-latest.tgz\n")),(0,r.kt)("p",null,"3) start a local server with"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm run serve\n")),(0,r.kt)("p",null,'The traditional site URL is http://localhost:4200/ .  Open the page with a web\nbrowser and open the console.  In the "Elements" tab, the ',(0,r.kt)("inlineCode",{parentName:"p"},"app-root")," element\nwill have an ",(0,r.kt)("inlineCode",{parentName:"p"},"ng-version")," attribute."),(0,r.kt)("p",null,"4) build the app with"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm run build\n")))}h.isMDXComponent=!0}}]);