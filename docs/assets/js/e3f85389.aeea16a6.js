"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6142],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>c});var l=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,l,a=function(e,t){if(null==e)return{};var n,l,a={},r=Object.keys(e);for(l=0;l<r.length;l++)n=r[l],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(l=0;l<r.length;l++)n=r[l],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=l.createContext({}),o=function(e){var t=l.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=o(e.components);return l.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return l.createElement(l.Fragment,{},t)}},u=l.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,p=d(e,["components","mdxType","originalType","parentName"]),u=o(n),c=a,k=u["".concat(s,".").concat(c)]||u[c]||m[c]||r;return n?l.createElement(k,i(i({ref:t},p),{},{components:n})):l.createElement(k,i({ref:t},p))}));function c(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=u;var d={};for(var s in t)hasOwnProperty.call(t,s)&&(d[s]=t[s]);d.originalType=e,d.mdxType="string"==typeof e?e:a,i[1]=d;for(var o=2;o<r;o++)i[o]=n[o];return l.createElement.apply(null,i)}return l.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8032:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>d,toc:()=>o});var l=n(7462),a=(n(7294),n(3905));const r={sidebar_position:1},i="Addresses and Ranges",d={unversionedId:"csf/general",id:"csf/general",title:"Addresses and Ranges",description:'The "Common Spreadsheet Format" (CSF) is the object model used by SheetJS.',source:"@site/docs/07-csf/01-general.md",sourceDirName:"07-csf",slug:"/csf/general",permalink:"/docs/csf/general",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Data Export",permalink:"/docs/solutions/output"},next:{title:"Cell Object",permalink:"/docs/csf/cell"}},s={},o=[{value:"Cell Addresses",id:"cell-addresses",level:2},{value:"Cell Ranges",id:"cell-ranges",level:2},{value:"Column and Row Ranges",id:"column-and-row-ranges",level:3},{value:"A1-Style",id:"a1-style",level:2},{value:"A1 Utilities",id:"a1-utilities",level:3},{value:"Column Names",id:"column-names",level:4},{value:"Row Names",id:"row-names",level:4},{value:"Cell Addresses",id:"cell-addresses-1",level:4},{value:"Cell Ranges",id:"cell-ranges-1",level:4}],p={toc:o};function m(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,l.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"addresses-and-ranges"},"Addresses and Ranges"),(0,a.kt)("p",null,'The "Common Spreadsheet Format" (CSF) is the object model used by SheetJS.'),(0,a.kt)("h2",{id:"cell-addresses"},"Cell Addresses"),(0,a.kt)("p",null,"Cell address objects are stored as ",(0,a.kt)("inlineCode",{parentName:"p"},"{c:C, r:R}")," where ",(0,a.kt)("inlineCode",{parentName:"p"},"C")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"R")," are 0-indexed\ncolumn and row numbers, respectively.  For example, the cell address ",(0,a.kt)("inlineCode",{parentName:"p"},"B5")," is\nrepresented by the object ",(0,a.kt)("inlineCode",{parentName:"p"},"{c:1, r:4}"),"."),(0,a.kt)("h2",{id:"cell-ranges"},"Cell Ranges"),(0,a.kt)("p",null,"Cell range objects are stored as ",(0,a.kt)("inlineCode",{parentName:"p"},"{s:S, e:E}")," where ",(0,a.kt)("inlineCode",{parentName:"p"},"S")," is the first cell and\n",(0,a.kt)("inlineCode",{parentName:"p"},"E")," is the last cell in the range.  The ranges are inclusive.  For example, the\nrange ",(0,a.kt)("inlineCode",{parentName:"p"},"A3:B7")," is represented by the object ",(0,a.kt)("inlineCode",{parentName:"p"},"{s:{c:0, r:2}, e:{c:1, r:6}}"),"."),(0,a.kt)("h3",{id:"column-and-row-ranges"},"Column and Row Ranges"),(0,a.kt)("p",null,"A column range (spanning every row) is represented with the starting row ",(0,a.kt)("inlineCode",{parentName:"p"},"0")," and\nthe ending row ",(0,a.kt)("inlineCode",{parentName:"p"},"1048575"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"{ s: { c: 0, r: 0 }, e: { c: 0, r: 1048575 } } // A:A\n{ s: { c: 1, r: 0 }, e: { c: 2, r: 1048575 } } // B:C\n")),(0,a.kt)("p",null,"A row range (spanning every column) is represented with the starting col ",(0,a.kt)("inlineCode",{parentName:"p"},"0")," and\nthe ending col ",(0,a.kt)("inlineCode",{parentName:"p"},"16383"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"{ s: { c: 0, r: 0 }, e: { c: 16383, r: 0 } } // 1:1\n{ s: { c: 0, r: 1 }, e: { c: 16383, r: 2 } } // 2:3\n")),(0,a.kt)("h1",{id:"common-spreadsheet-address-styles"},"Common Spreadsheet Address Styles"),(0,a.kt)("h2",{id:"a1-style"},"A1-Style"),(0,a.kt)("p",null,"A1-style is the default address style in Lotus 1-2-3 and Excel."),(0,a.kt)("p",null,"Columns are specified with letters, counting from ",(0,a.kt)("inlineCode",{parentName:"p"},"A")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"Z"),", then ",(0,a.kt)("inlineCode",{parentName:"p"},"AA")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"ZZ"),",\nthen ",(0,a.kt)("inlineCode",{parentName:"p"},"AAA"),".  Some sample values, along with SheetJS column indices, are listed:"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"left"},"Ordinal"),(0,a.kt)("th",{parentName:"tr",align:"left"},"A1 Name"),(0,a.kt)("th",{parentName:"tr",align:"right"},"SheetJS"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"First"),(0,a.kt)("td",{parentName:"tr",align:"left"},(0,a.kt)("inlineCode",{parentName:"td"},"A")),(0,a.kt)("td",{parentName:"tr",align:"right"},(0,a.kt)("inlineCode",{parentName:"td"},"0"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Second"),(0,a.kt)("td",{parentName:"tr",align:"left"},(0,a.kt)("inlineCode",{parentName:"td"},"B")),(0,a.kt)("td",{parentName:"tr",align:"right"},(0,a.kt)("inlineCode",{parentName:"td"},"1"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"26th"),(0,a.kt)("td",{parentName:"tr",align:"left"},(0,a.kt)("inlineCode",{parentName:"td"},"Z")),(0,a.kt)("td",{parentName:"tr",align:"right"},(0,a.kt)("inlineCode",{parentName:"td"},"25"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"27th"),(0,a.kt)("td",{parentName:"tr",align:"left"},(0,a.kt)("inlineCode",{parentName:"td"},"AA")),(0,a.kt)("td",{parentName:"tr",align:"right"},(0,a.kt)("inlineCode",{parentName:"td"},"26"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"702st"),(0,a.kt)("td",{parentName:"tr",align:"left"},(0,a.kt)("inlineCode",{parentName:"td"},"ZZ")),(0,a.kt)("td",{parentName:"tr",align:"right"},(0,a.kt)("inlineCode",{parentName:"td"},"701"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"703rd"),(0,a.kt)("td",{parentName:"tr",align:"left"},(0,a.kt)("inlineCode",{parentName:"td"},"AAA")),(0,a.kt)("td",{parentName:"tr",align:"right"},(0,a.kt)("inlineCode",{parentName:"td"},"702"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"16384th"),(0,a.kt)("td",{parentName:"tr",align:"left"},(0,a.kt)("inlineCode",{parentName:"td"},"XFD")),(0,a.kt)("td",{parentName:"tr",align:"right"},(0,a.kt)("inlineCode",{parentName:"td"},"16383"))))),(0,a.kt)("p",null,"Rows are specified with numbers, starting from ",(0,a.kt)("inlineCode",{parentName:"p"},"1")," for the first row.  SheetJS\nAPIs that take row indices start from ",(0,a.kt)("inlineCode",{parentName:"p"},"0")," (ECMAScript convention)."),(0,a.kt)("p",null,'A cell address is the concatenation of column text and row number.  For example,\nthe cell in the third column and fourth row is "C4".'),(0,a.kt)("p",null,"A cell range is represented as the top-left cell of the range, followed by ",(0,a.kt)("inlineCode",{parentName:"p"},":"),",\nfollowed by the bottom-right cell of the range. For example, the range ",(0,a.kt)("inlineCode",{parentName:"p"},'"C2:D4"'),"\nincludes 6 cells marked with \u2592 in the table below:"),(0,a.kt)("table",null,(0,a.kt)("tbody",null,(0,a.kt)("tr",null,(0,a.kt)("th",null," "),(0,a.kt)("th",null,"A"),(0,a.kt)("th",null,"B"),(0,a.kt)("th",null,"C"),(0,a.kt)("th",null,"D"),(0,a.kt)("th",null,"E")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"1"),(0,a.kt)("td",null," "),(0,a.kt)("td",null," "),(0,a.kt)("td",null," "),(0,a.kt)("td",null," "),(0,a.kt)("td",null," ")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"2"),(0,a.kt)("td",null," "),(0,a.kt)("td",null," "),(0,a.kt)("td",null,"\u2592"),(0,a.kt)("td",null,"\u2592"),(0,a.kt)("td",null," ")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"3"),(0,a.kt)("td",null," "),(0,a.kt)("td",null," "),(0,a.kt)("td",null,"\u2592"),(0,a.kt)("td",null,"\u2592"),(0,a.kt)("td",null," ")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"4"),(0,a.kt)("td",null," "),(0,a.kt)("td",null," "),(0,a.kt)("td",null,"\u2592"),(0,a.kt)("td",null,"\u2592"),(0,a.kt)("td",null," ")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"5"),(0,a.kt)("td",null," "),(0,a.kt)("td",null," "),(0,a.kt)("td",null," "),(0,a.kt)("td",null," "),(0,a.kt)("td",null," ")))),(0,a.kt)("p",null,"A column range is represented by the left-most column, followed by ",(0,a.kt)("inlineCode",{parentName:"p"},":"),", followed\nby the right-most column.  For example, the range ",(0,a.kt)("inlineCode",{parentName:"p"},"C:D")," represents the third and\nfourth columns."),(0,a.kt)("p",null,"A row range is represented by the top-most row, followed by ",(0,a.kt)("inlineCode",{parentName:"p"},":"),", followed by the\nbottom-most column.  For example, ",(0,a.kt)("inlineCode",{parentName:"p"},"2:4")," represents the second/third/fourth rows."),(0,a.kt)("h3",{id:"a1-utilities"},"A1 Utilities"),(0,a.kt)("h4",{id:"column-names"},"Column Names"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Get the SheetJS index from an A1-Style column")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'var col_index = XLSX.utils.decode_col("D");\n')),(0,a.kt)("p",null,"The argument is expected to be a string representing a column."),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Get the A1-Style column string from a SheetJS index")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var col_name = XLSX.utils.encode_col(3);\n")),(0,a.kt)("p",null,"The argument is expected to be a SheetJS column (non-negative integer)."),(0,a.kt)("h4",{id:"row-names"},"Row Names"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Get the SheetJS index from an A1-Style row")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'var row_index = XLSX.utils.decode_row("4");\n')),(0,a.kt)("p",null,"The argument is expected to be a string representing a row."),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Get the A1-Style row string from a SheetJS index")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var row_name = XLSX.utils.encode_row(3);\n")),(0,a.kt)("p",null,"The argument is expected to be a SheetJS column (non-negative integer)."),(0,a.kt)("h4",{id:"cell-addresses-1"},"Cell Addresses"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Generate a SheetJS cell address from an A1-Style address string")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'var address = XLSX.utils.decode_cell("A2");\n')),(0,a.kt)("p",null,"The argument is expected to be a string representing a single cell address."),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Generate an A1-style address string from a SheetJS cell address")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var a1_addr = XLSX.utils.encode_cell({r:1, c:0});\n")),(0,a.kt)("p",null,"The argument is expected to be a SheetJS cell address"),(0,a.kt)("h4",{id:"cell-ranges-1"},"Cell Ranges"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Generate a SheetJS cell range from an A1-style range string")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'var range = XLSX.utils.decode_range("A1:D3");\n')),(0,a.kt)("p",null,"The argument is expected to be a string representing a range or a single cell\naddress.  The single cell address is interpreted as a single cell range, so\n",(0,a.kt)("inlineCode",{parentName:"p"},'XLSX.utils.decode_range("D3")')," is the same as ",(0,a.kt)("inlineCode",{parentName:"p"},'XLSX.utils.decode_range("D3:D3")')),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"Generate an A1-style address string from a SheetJS cell address")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var a1_range = XLSX.utils.encode_range({ s: { c: 0, r: 0 }, e: { c: 3, r: 2 } });\n")),(0,a.kt)("p",null,"The argument is expected to be a SheetJS cell range."))}m.isMDXComponent=!0}}]);