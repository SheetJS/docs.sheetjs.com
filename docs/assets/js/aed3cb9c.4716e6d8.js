"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7609],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>k});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),d=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=d(e.components);return r.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=d(a),k=n,f=c["".concat(s,".").concat(k)]||c[k]||m[k]||i;return a?r.createElement(f,l(l({ref:t},p),{},{components:a})):r.createElement(f,l({ref:t},p))}));function k(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,l=new Array(i);l[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:n,l[1]=o;for(var d=2;d<i;d++)l[d]=a[d];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}c.displayName="MDXCreateElement"},9978:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>m,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var r=a(7462),n=(a(7294),a(3905));const i={sidebar_position:1,hide_table_of_contents:!0},l="File Formats",o={unversionedId:"miscellany/formats",id:"miscellany/formats",title:"File Formats",description:"graph of format support",source:"@site/docs/09-miscellany/01-formats.md",sourceDirName:"09-miscellany",slug:"/miscellany/formats",permalink:"/docs/miscellany/formats",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,hide_table_of_contents:!0},sidebar:"tutorialSidebar",previous:{title:"Utility Functions",permalink:"/docs/api/utilities"},next:{title:"Testing",permalink:"/docs/miscellany/testing"}},s={},d=[{value:"Excel 2007+ XML (XLSX/XLSM)",id:"excel-2007-xml-xlsxxlsm",level:3},{value:"Excel 2.0-95 (BIFF2/BIFF3/BIFF4/BIFF5)",id:"excel-20-95-biff2biff3biff4biff5",level:3},{value:"Excel 97-2004 Binary (BIFF8)",id:"excel-97-2004-binary-biff8",level:3},{value:"Excel 2003-2004 (SpreadsheetML)",id:"excel-2003-2004-spreadsheetml",level:3},{value:"Excel 2007+ Binary (XLSB, BIFF12)",id:"excel-2007-binary-xlsb-biff12",level:3},{value:"Delimiter-Separated Values (CSV/TXT)",id:"delimiter-separated-values-csvtxt",level:3},{value:"Miscellaneous Workbook Formats",id:"miscellaneous-workbook-formats",level:3},{value:"Lotus 1-2-3 (WKS/WK1/WK2/WK3/WK4/123)",id:"lotus-1-2-3-wkswk1wk2wk3wk4123",level:4},{value:"Quattro Pro (WQ1/WQ2/WB1/WB2/WB3/QPW)",id:"quattro-pro-wq1wq2wb1wb2wb3qpw",level:4},{value:"Works for DOS / Windows Spreadsheet (WKS/XLR)",id:"works-for-dos--windows-spreadsheet-wksxlr",level:4},{value:"Numbers 3.0+ / iWork 2013+ Spreadsheet (NUMBERS)",id:"numbers-30--iwork-2013-spreadsheet-numbers",level:4},{value:"OpenDocument Spreadsheet (ODS/FODS)",id:"opendocument-spreadsheet-odsfods",level:4},{value:"Uniform Office Spreadsheet (UOS1/2)",id:"uniform-office-spreadsheet-uos12",level:4},{value:"Miscellaneous Worksheet Formats",id:"miscellaneous-worksheet-formats",level:3},{value:"dBASE and Visual FoxPro (DBF)",id:"dbase-and-visual-foxpro-dbf",level:4},{value:"Symbolic Link (SYLK)",id:"symbolic-link-sylk",level:4},{value:"Lotus Formatted Text (PRN)",id:"lotus-formatted-text-prn",level:4},{value:"Data Interchange Format (DIF)",id:"data-interchange-format-dif",level:4},{value:"HTML",id:"html",level:4},{value:"Rich Text Format (RTF)",id:"rich-text-format-rtf",level:4},{value:"Ethercalc Record Format (ETH)",id:"ethercalc-record-format-eth",level:4}],p={toc:d};function m(e){let{components:t,...i}=e;return(0,n.kt)("wrapper",(0,r.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"file-formats"},"File Formats"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"graph of format support",src:a(7177).Z,width:"704",height:"689"})),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"graph legend",src:a(410).Z,width:"235",height:"249"})),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Format"),(0,n.kt)("th",{parentName:"tr",align:"center"},"Read"),(0,n.kt)("th",{parentName:"tr",align:"center"},"Write"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("strong",{parentName:"td"},"Excel Worksheet/Workbook Formats")),(0,n.kt)("td",{parentName:"tr",align:"center"},":-----:"),(0,n.kt)("td",{parentName:"tr",align:"center"},":-----:")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 2007+ XML Formats (XLSX/XLSM)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 2007+ Binary Format (XLSB BIFF12)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},'Excel 2003-2004 XML Format (XML "SpreadsheetML")'),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 97-2004 (XLS BIFF8)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 5.0/95 (XLS BIFF5)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 4.0 (XLS/XLW BIFF4)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 3.0 (XLS BIFF3)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 2.0/2.1 / Multiplan 4.x DOS (XLS BIFF2)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("strong",{parentName:"td"},"Excel Supported Text Formats")),(0,n.kt)("td",{parentName:"tr",align:"center"},":-----:"),(0,n.kt)("td",{parentName:"tr",align:"center"},":-----:")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Delimiter-Separated Values (CSV/TXT)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Data Interchange Format (DIF)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Symbolic Link (SYLK/SLK)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Lotus Formatted Text (PRN)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"UTF-16 Unicode Text (TXT)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("strong",{parentName:"td"},"Other Workbook/Worksheet Formats")),(0,n.kt)("td",{parentName:"tr",align:"center"},":-----:"),(0,n.kt)("td",{parentName:"tr",align:"center"},":-----:")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Numbers 3.0+ / iWork 2013+ Spreadsheet (NUMBERS)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"OpenDocument Spreadsheet (ODS)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Flat XML ODF Spreadsheet (FODS)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Uniform Office Format Spreadsheet (\u6807\u6587\u901a UOS1/UOS2)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"dBASE II/III/IV / Visual FoxPro (DBF)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Lotus 1-2-3 (WK1/WK3)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Lotus 1-2-3 (WKS/WK2/WK4/123)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Quattro Pro Spreadsheet (WQ1/WQ2/WB1/WB2/WB3/QPW)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Works 1.x-3.x DOS / 2.x-5.x Windows Spreadsheet (WKS)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Works 6.x-9.x Spreadsheet (XLR)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("strong",{parentName:"td"},"Other Common Spreadsheet Output Formats")),(0,n.kt)("td",{parentName:"tr",align:"center"},":-----:"),(0,n.kt)("td",{parentName:"tr",align:"center"},":-----:")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"HTML Tables"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Rich Text Format tables (RTF)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Ethercalc Record Format (ETH)"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714"),(0,n.kt)("td",{parentName:"tr",align:"center"},"\u2714")))),(0,n.kt)("p",null,"Features not supported by a given file format will not be written.  Formats with\nrange limits will be silently truncated:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Format"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Last Cell"),(0,n.kt)("th",{parentName:"tr",align:"right"},"Max Cols"),(0,n.kt)("th",{parentName:"tr",align:"right"},"Max Rows"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 2007+ XML Formats (XLSX/XLSM)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"XFD1048576")),(0,n.kt)("td",{parentName:"tr",align:"right"},"16384"),(0,n.kt)("td",{parentName:"tr",align:"right"},"1048576")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 2007+ Binary Format (XLSB BIFF12)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"XFD1048576")),(0,n.kt)("td",{parentName:"tr",align:"right"},"16384"),(0,n.kt)("td",{parentName:"tr",align:"right"},"1048576")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Numbers 12.1 (NUMBERS)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"ALL1000000")),(0,n.kt)("td",{parentName:"tr",align:"right"},"1000"),(0,n.kt)("td",{parentName:"tr",align:"right"},"1000000")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Quattro Pro 9+ (QPW)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"IV1000000 ")),(0,n.kt)("td",{parentName:"tr",align:"right"},"256"),(0,n.kt)("td",{parentName:"tr",align:"right"},"1000000")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 97-2004 (XLS BIFF8)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"IV65536   ")),(0,n.kt)("td",{parentName:"tr",align:"right"},"256"),(0,n.kt)("td",{parentName:"tr",align:"right"},"65536")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 5.0/95 (XLS BIFF5)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"IV16384   ")),(0,n.kt)("td",{parentName:"tr",align:"right"},"256"),(0,n.kt)("td",{parentName:"tr",align:"right"},"16384")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 4.0 (XLS BIFF4)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"IV16384   ")),(0,n.kt)("td",{parentName:"tr",align:"right"},"256"),(0,n.kt)("td",{parentName:"tr",align:"right"},"16384")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 3.0 (XLS BIFF3)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"IV16384   ")),(0,n.kt)("td",{parentName:"tr",align:"right"},"256"),(0,n.kt)("td",{parentName:"tr",align:"right"},"16384")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Excel 2.0/2.1 (XLS BIFF2)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"IV16384   ")),(0,n.kt)("td",{parentName:"tr",align:"right"},"256"),(0,n.kt)("td",{parentName:"tr",align:"right"},"16384")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Lotus 1-2-3 R2 - R5 (WK1/WK3/WK4)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"IV8192    ")),(0,n.kt)("td",{parentName:"tr",align:"right"},"256"),(0,n.kt)("td",{parentName:"tr",align:"right"},"8192")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Lotus 1-2-3 R1 (WKS)"),(0,n.kt)("td",{parentName:"tr",align:"left"},(0,n.kt)("inlineCode",{parentName:"td"},"IV2048    ")),(0,n.kt)("td",{parentName:"tr",align:"right"},"256"),(0,n.kt)("td",{parentName:"tr",align:"right"},"2048")))),(0,n.kt)("p",null,"Excel 2003 SpreadsheetML range limits are governed by the version of Excel and\nare not enforced by the writer."),(0,n.kt)("h3",{id:"excel-2007-xml-xlsxxlsm"},"Excel 2007+ XML (XLSX/XLSM)"),(0,n.kt)("p",null,"XLSX and XLSM files are ZIP containers containing a series of XML files in\naccordance with the Open Packaging Conventions (OPC).  The XLSM format, almost\nidentical to XLSX, is used for files containing macros."),(0,n.kt)("p",null,"The format is standardized in ",(0,n.kt)("inlineCode",{parentName:"p"},"ECMA-376")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"ISO/IEC 29500"),".  Excel does not\nfollow the specification, and there are additional documents discussing how\nExcel deviates from the specification."),(0,n.kt)("h3",{id:"excel-20-95-biff2biff3biff4biff5"},"Excel 2.0-95 (BIFF2/BIFF3/BIFF4/BIFF5)"),(0,n.kt)("p",null,"BIFF 2/3 XLS are single-sheet streams of binary records.  Excel 4 introduced\nthe concept of a workbook (",(0,n.kt)("inlineCode",{parentName:"p"},"XLW")," files) but also had single-sheet ",(0,n.kt)("inlineCode",{parentName:"p"},"XLS")," format.\nThe structure is largely similar to the Lotus 1-2-3 file formats.  BIFF5/8/12\nextended the format in various ways but largely stuck to the same record format."),(0,n.kt)("p",null,'Multiplan 4 "Normal" files are identical in structure to BIFF2 and use the same\ncell value records.  There are some different record types for more advanced\nfeatures like Print Settings.  The BIFF2 writer generates files that can be read\nin Multiplan 4 and the parser can extract values from "Normal" files.'),(0,n.kt)("p",null,"There is no official specification for any of these formats.  Excel 95 can write\nfiles in these formats, so record lengths and fields were determined by writing\nin all of the supported formats and comparing files.  Excel 2016 can generate\nBIFF5 files, enabling a full suite of file tests starting from XLSX or BIFF2."),(0,n.kt)("h3",{id:"excel-97-2004-binary-biff8"},"Excel 97-2004 Binary (BIFF8)"),(0,n.kt)("p",null,"BIFF8 exclusively uses the Compound File Binary container format, splitting some\ncontent into streams within the file.  At its core, it still uses an extended\nversion of the binary record format from older versions of BIFF."),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"MS-XLS")," specification covers the basics of the file format, and other\nspecifications expand on serialization of features like properties."),(0,n.kt)("h3",{id:"excel-2003-2004-spreadsheetml"},"Excel 2003-2004 (SpreadsheetML)"),(0,n.kt)("p",null,"Predating XLSX, SpreadsheetML files are simple XML files.  There is no official\nand comprehensive specification, although MS has released documentation on the\nformat.  Since Excel 2016 can generate SpreadsheetML files, mapping features is\npretty straightforward."),(0,n.kt)("h3",{id:"excel-2007-binary-xlsb-biff12"},"Excel 2007+ Binary (XLSB, BIFF12)"),(0,n.kt)("p",null,"Introduced in parallel with XLSX, the XLSB format combines the BIFF architecture\nwith the content separation and ZIP container of XLSX.  For the most part nodes\nin an XLSX sub-file can be mapped to XLSB records in a corresponding sub-file."),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"MS-XLSB")," specification covers the basics of the file format, and other\nspecifications expand on serialization of features like properties."),(0,n.kt)("h3",{id:"delimiter-separated-values-csvtxt"},"Delimiter-Separated Values (CSV/TXT)"),(0,n.kt)("p",null,"Excel CSV deviates from RFC4180 in a number of important ways.  The generated\nCSV files should generally work in Excel although they may not work in RFC4180\ncompatible readers.  The parser should generally understand Excel CSV. The\nwriter proactively generates cells for formulae if values are unavailable."),(0,n.kt)("p",null,"Excel TXT uses tab as the delimiter and code page 1200."),(0,n.kt)("p",null,"Like in Excel, files starting with ",(0,n.kt)("inlineCode",{parentName:"p"},'0x49 0x44 ("ID")')," are treated as Symbolic\nLink files.  Unlike Excel, if the file does not have a valid SYLK header, it\nwill be proactively reinterpreted as CSV.  There are some files with semicolon\ndelimiter that align with a valid SYLK file.  For the broadest compatibility,\nall cells with the value of ",(0,n.kt)("inlineCode",{parentName:"p"},"ID")," are automatically wrapped in double-quotes."),(0,n.kt)("h3",{id:"miscellaneous-workbook-formats"},"Miscellaneous Workbook Formats"),(0,n.kt)("p",null,"Support for other formats is generally far behind XLS/XLSB/XLSX support, due in\npart to a lack of publicly available documentation.  Test files were produced in\nthe respective apps and compared to their XLS exports to determine structure.\nThe main focus is data extraction."),(0,n.kt)("h4",{id:"lotus-1-2-3-wkswk1wk2wk3wk4123"},"Lotus 1-2-3 (WKS/WK1/WK2/WK3/WK4/123)"),(0,n.kt)("p",null,"The Lotus formats consist of binary records similar to the BIFF structure. Lotus\ndid release a specification decades ago covering the original WK1 format.  Other\nfeatures were deduced by producing files and comparing to Excel support."),(0,n.kt)("p",null,"Generated WK1 worksheets are compatible with Lotus 1-2-3 R2 and Excel 5.0."),(0,n.kt)("p",null,"Generated WK3 workbooks are compatible with Lotus 1-2-3 R9 and Excel 5.0."),(0,n.kt)("h4",{id:"quattro-pro-wq1wq2wb1wb2wb3qpw"},"Quattro Pro (WQ1/WQ2/WB1/WB2/WB3/QPW)"),(0,n.kt)("p",null,"The Quattro Pro formats use binary records in the same way as BIFF and Lotus.\nSome of the newer formats (namely WB3 and QPW) use a CFB enclosure just like\nBIFF8 XLS."),(0,n.kt)("h4",{id:"works-for-dos--windows-spreadsheet-wksxlr"},"Works for DOS / Windows Spreadsheet (WKS/XLR)"),(0,n.kt)("p",null,"All versions of Works were limited to a single worksheet."),(0,n.kt)("p",null,"Works for DOS 1.x - 3.x and Works for Windows 2.x extends the Lotus WKS format\nwith additional record types."),(0,n.kt)("p",null,"Works for Windows 3.x - 5.x uses the same format and WKS extension.  The ",(0,n.kt)("inlineCode",{parentName:"p"},"BOF"),"\nrecord has type ",(0,n.kt)("inlineCode",{parentName:"p"},"0xFF")),(0,n.kt)("p",null,"Works for Windows 6.x - 9.x use the XLR format.  XLR is nearly identical to\nBIFF8 XLS: it uses the CFB container with a Workbook stream.  Works 9 saves the\nexact Workbook stream for the XLR and the 97-2003 XLS export.  Works 6 XLS\nincludes two empty worksheets but the main worksheet has an identical encoding.\nXLR also includes a ",(0,n.kt)("inlineCode",{parentName:"p"},"WksSSWorkBook")," stream similar to Lotus FM3/FMT files."),(0,n.kt)("h4",{id:"numbers-30--iwork-2013-spreadsheet-numbers"},"Numbers 3.0+ / iWork 2013+ Spreadsheet (NUMBERS)"),(0,n.kt)("p",null,"iWork 2013 (Numbers 3.0 / Pages 5.0 / Keynote 6.0) switched from a proprietary\nXML-based format to the current file format based on the iWork Archive (IWA).\nThis format has been used up through the current release (Numbers 12.1) as well\nas the iCloud.com web interface to Numbers."),(0,n.kt)("p",null,"The parser focuses on extracting raw data from tables.  Numbers technically\nsupports multiple tables in a logical worksheet, including custom titles.  This\nparser will generate one worksheet per Numbers table."),(0,n.kt)("p",null,"The writer currently exports a small range from the first worksheet."),(0,n.kt)("h4",{id:"opendocument-spreadsheet-odsfods"},"OpenDocument Spreadsheet (ODS/FODS)"),(0,n.kt)("p",null,"ODS is an XML-in-ZIP format akin to XLSX while FODS is an XML format akin to\nSpreadsheetML.  Both are detailed in the OASIS standard, but LibreOffice adds\nundocumented extensions.  The parsers and writers do not implement the full\nstandard, instead focusing on parts necessary to extract and store raw data."),(0,n.kt)("h4",{id:"uniform-office-spreadsheet-uos12"},"Uniform Office Spreadsheet (UOS1/2)"),(0,n.kt)("p",null,"UOS is a very similar format, and it comes in 2 varieties corresponding to ODS\nand FODS respectively.  For the most part, the difference between the formats\nis in the names of tags and attributes."),(0,n.kt)("h3",{id:"miscellaneous-worksheet-formats"},"Miscellaneous Worksheet Formats"),(0,n.kt)("p",null,"Many older formats supported only one worksheet:"),(0,n.kt)("h4",{id:"dbase-and-visual-foxpro-dbf"},"dBASE and Visual FoxPro (DBF)"),(0,n.kt)("p",null,"DBF is really a typed table format: each column can only hold one data type and\neach record omits type information.  The parser generates a header row and\ninserts records starting at the second row of the worksheet.  The writer makes\nfiles compatible with Visual FoxPro extensions."),(0,n.kt)("p",null,"Multi-file extensions like external memos and tables are currently unsupported,\nlimited by the general ability to read arbitrary files in the web browser.  The\nreader understands DBF Level 7 extensions like ",(0,n.kt)("inlineCode",{parentName:"p"},"DATETIME"),"."),(0,n.kt)("h4",{id:"symbolic-link-sylk"},"Symbolic Link (SYLK)"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://oss.sheetjs.com/notes/sylk/"},"https://oss.sheetjs.com/notes/sylk/")," is an informal specification based on our\nexperimentation and previous documentation efforts."),(0,n.kt)("h4",{id:"lotus-formatted-text-prn"},"Lotus Formatted Text (PRN)"),(0,n.kt)("p",null,"There is no real documentation, and in fact Excel treats PRN as an output-only\nfile format.  Nevertheless we can guess the column widths and reverse-engineer\nthe original layout.  Excel's 240 character width limitation is not enforced."),(0,n.kt)("h4",{id:"data-interchange-format-dif"},"Data Interchange Format (DIF)"),(0,n.kt)("p",null,"There is no unified definition.  Visicalc DIF differs from Lotus DIF, and both\ndiffer from Excel DIF.  Where ambiguous, the parser/writer follows the expected\nbehavior from Excel.  In particular, Excel extends DIF in incompatible ways:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Since Excel automatically converts numbers-as-strings to numbers, numeric\nstring constants are converted to formulae: ",(0,n.kt)("inlineCode",{parentName:"li"},'"0.3" -> "=""0.3""')),(0,n.kt)("li",{parentName:"ul"},"DIF technically expects numeric cells to hold the raw numeric data, but Excel\npermits formatted numbers (including dates)"),(0,n.kt)("li",{parentName:"ul"},"DIF technically has no support for formulae, but Excel will automatically\nconvert plain formulae.  Array formulae are not preserved.")),(0,n.kt)("h4",{id:"html"},"HTML"),(0,n.kt)("p",null,"Excel HTML worksheets include special metadata encoded in styles.  For example,\n",(0,n.kt)("inlineCode",{parentName:"p"},"mso-number-format")," is a localized string containing the number format.  Despite\nthe metadata the output is valid HTML, although it does accept bare ",(0,n.kt)("inlineCode",{parentName:"p"},"&")," symbols."),(0,n.kt)("p",null,"The writer adds type metadata to the TD elements via the ",(0,n.kt)("inlineCode",{parentName:"p"},"t")," tag.  The parser\nlooks for those tags and overrides the default interpretation. For example, text\nlike ",(0,n.kt)("inlineCode",{parentName:"p"},"<td>12345</td>")," will be parsed as numbers but ",(0,n.kt)("inlineCode",{parentName:"p"},'<td t="s">12345</td>')," will\nbe parsed as text."),(0,n.kt)("h4",{id:"rich-text-format-rtf"},"Rich Text Format (RTF)"),(0,n.kt)("p",null,"Excel RTF worksheets are stored in clipboard when copying cells or ranges from a\nworksheet.  The supported codes are a subset of the Word RTF support."),(0,n.kt)("h4",{id:"ethercalc-record-format-eth"},"Ethercalc Record Format (ETH)"),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://ethercalc.net/"},"Ethercalc")," is an open source web spreadsheet powered by\na record format reminiscent of SYLK wrapped in a MIME multi-part message."))}m.isMDXComponent=!0},7177:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/formats-cb6e46647552e547df13b901bfc4996f.png"},410:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/legend-1942c15d931be11b03f75bcf915afcb6.png"}}]);