"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7694],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>u});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=p(n),u=o,h=m["".concat(s,".").concat(u)]||m[u]||d[u]||r;return n?a.createElement(h,l(l({ref:t},c),{},{components:n})):a.createElement(h,l({ref:t},c))}));function u(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,l=new Array(r);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var p=2;p<r;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5007:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var a=n(7462),o=(n(7294),n(3905));const r={sidebar_position:1},l="Salesforce LWC",i={unversionedId:"getting-started/demos/salesforce",id:"getting-started/demos/salesforce",title:"Salesforce LWC",description:'Salesforce apps can use third-party libraries in "Lightning Web Components".',source:"@site/docs/04-getting-started/03-demos/01-salesforce.md",sourceDirName:"04-getting-started/03-demos",slug:"/getting-started/demos/salesforce",permalink:"/docs/getting-started/demos/salesforce",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Demo Projects",permalink:"/docs/getting-started/demos/"},next:{title:"Adobe Apps",permalink:"/docs/getting-started/demos/extendscript"}},s={},p=[{value:"Getting Started",id:"getting-started",level:2},{value:"Create Sample Project and Component",id:"create-sample-project-and-component",level:3},{value:"Deploy Sample Project",id:"deploy-sample-project",level:3},{value:"Initialize App Page",id:"initialize-app-page",level:3},{value:"Adding the Standalone Script",id:"adding-the-standalone-script",level:2},{value:"Test the Static Resource",id:"test-the-static-resource",level:3},{value:"Exporting Data from SF Lists",id:"exporting-data-from-sf-lists",level:2},{value:"Steps",id:"steps",level:3},{value:"Getting Account Data",id:"getting-account-data",level:4},{value:"Generating an Array of Arrays",id:"generating-an-array-of-arrays",level:4},{value:"Complete Example",id:"complete-example",level:3}],c={toc:p};function d(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"salesforce-lwc"},"Salesforce LWC"),(0,o.kt)("p",null,'Salesforce apps can use third-party libraries in "Lightning Web Components".'),(0,o.kt)("p",null,"This demo assumes familiarity with Lightning Web Components.  Salesforce has a\n",(0,o.kt)("a",{parentName:"p",href:"https://developer.salesforce.com/docs/component-library/documentation/en/lwc/lwc.get_started_introduction"},"detailed introduction.")),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Some of the details may differ across releases of Salesforce. This demo is based\non Lightning API version ",(0,o.kt)("inlineCode",{parentName:"p"},"55.0")," and was last tested on 2022 June 26."),(0,o.kt)("p",{parentName:"admonition"},"Salesforce may change the platform in backwards-incompatible ways, so the demo\nmay require some adjustments.  The official documentation should be consulted.")),(0,o.kt)("h2",{id:"getting-started"},"Getting Started"),(0,o.kt)("p",null,'This demo was built on a "Developer Edition" account. At the time of writing, an\n',(0,o.kt)("a",{parentName:"p",href:"https://developer.salesforce.com/signup"},"account can be created for free.")),(0,o.kt)("h3",{id:"create-sample-project-and-component"},"Create Sample Project and Component"),(0,o.kt)("p",null,"Following the steps in ",(0,o.kt)("a",{parentName:"p",href:"https://developer.salesforce.com/docs/component-library/documentation/en/lwc/lwc.get_started_sfdx_deploy"},'"Develop in Non-Scratch Orgs"'),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"## Login\nsfdx force:auth:web:login -d -a LWC-Hub\n\n## Create Sample Project and Component\nsfdx force:project:create --projectname SheetForce\ncd SheetForce\nsfdx force:lightning:component:create --type lwc -n sheetComponent -d force-app/main/default/lwc\n")),(0,o.kt)("p",null,"By default, the component will not be available to app pages.  A few files must\nbe changed:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"force-app\\main\\default\\lwc\\sheetComponent\\sheetComponent.html")," add some HTML:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html",metastring:"force-app\\main\\default\\lwc\\sheetComponent\\sheetComponent.html","force-app\\main\\default\\lwc\\sheetComponent\\sheetComponent.html":!0},"<template>\n  \x3c!-- highlight-next-line --\x3e\n  <b>SheetForce demo</b>\n</template>\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"force-app\\main\\default\\lwc\\sheetComponent\\sheetComponent.js-meta.xml")," change\n",(0,o.kt)("inlineCode",{parentName:"p"},"isExposed")," from ",(0,o.kt)("inlineCode",{parentName:"p"},"false")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"true")," and add some metadata:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<LightningComponentBundle xmlns="http://soap.sforce.com/2006/04/metadata">\n  <apiVersion>55.0</apiVersion>\n  \x3c!-- highlight-start --\x3e\n  <isExposed>true</isExposed>\n  <masterLabel>SheetForce</masterLabel>\n  <description>SheetJS Demo</description>\n  <targets>\n    <target>lightning__AppPage</target>\n  </targets>\n  \x3c!-- highlight-end --\x3e\n</LightningComponentBundle>\n')),(0,o.kt)("h3",{id:"deploy-sample-project"},"Deploy Sample Project"),(0,o.kt)("p",null,"Deploy the project:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sfdx force:source:deploy -p force-app -u SALESFORCE@USER.NAME # replace with actual username\n")),(0,o.kt)("p",null,"The custom component can be found in Custom Code > Lightning Components."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"/files/sfcustcomp.png",alt:"Custom Component"})),(0,o.kt)("h3",{id:"initialize-app-page"},"Initialize App Page"),(0,o.kt)("p",null,'Create an "App Page" in the "Lightning App Builder".  Instructions are included\nin ',(0,o.kt)("a",{parentName:"p",href:"https://developer.salesforce.com/docs/component-library/documentation/en/lwc/lwc.get_started_sfdx_hello_world"},"Hello World in a Scratch Org")),(0,o.kt)("p",null,"The following options should be set:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'The "App Page" option should be selected.'),(0,o.kt)("li",{parentName:"ul"},'The App Label should be set to "SheetJS Demo".'),(0,o.kt)("li",{parentName:"ul"},'The "One Region" layout should be selected.')),(0,o.kt)("p",null,'Under Custom components, you should see "SheetForce".  Click and drag it into\nthe app builder main view to add it to the page.'),(0,o.kt)("p",null,'Click "Save" and click "Yes" to activate.  The following options should be set:'),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'Click "Change..." next to "Icon" and pick a memorable icon'),(0,o.kt)("li",{parentName:"ul"},'Under "Lightning Experience" click "LightningBolt" then "Add page to app"')),(0,o.kt)("p",null,'Click "Save" to activate the page, then click the left arrow to return to Setup.'),(0,o.kt)("p",null,'Click the App Launcher and select "Bolt Solutions" then "SheetJS Demo".  You\nshould see a page like'),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"/files/sfinitial.png",alt:"SheetForce Demo"})),(0,o.kt)("h2",{id:"adding-the-standalone-script"},"Adding the Standalone Script"),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"../../installation/standalone"},"standalone script")," can be downloaded and\nadded as a static resource.  Due to Salesforce naming restrictions, it will have\nto be renamed to ",(0,o.kt)("inlineCode",{parentName:"p"},"sheetjs.js")," when adding the static resource."),(0,o.kt)("p",null,"1) Download ",(0,o.kt)("a",{parentName:"p",href:"https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"},"https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js")),(0,o.kt)("admonition",{type:"warning"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},'DO NOT "COPY AND PASTE"!'),"  The file should be explicitly downloaded.  Copying\nand pasting corrupts the source code and the component will fail in subtle ways."),(0,o.kt)("p",{parentName:"admonition"},'The easiest approach is to right-click the link and select "Save Link As..."')),(0,o.kt)("p",null,"2) Move the file to the ",(0,o.kt)("inlineCode",{parentName:"p"},"force-app/main/default/staticresources/")," folder and\nrename the file to ",(0,o.kt)("inlineCode",{parentName:"p"},"sheetjs.js"),"."),(0,o.kt)("p",null,"3) Create ",(0,o.kt)("inlineCode",{parentName:"p"},"force-app/main/default/staticresources/sheetjs.resource-meta.xml"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<StaticResource xmlns="http://soap.sforce.com/2006/04/metadata">\n  <cacheControl>Private</cacheControl>\n  <contentType>application/javascript</contentType>\n</StaticResource>\n')),(0,o.kt)("p",null,"4) Deploy the project again:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sfdx force:source:deploy -p force-app -u SALESFORCE@USER.NAME # replace with actual username\n")),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"The official documentation recommends adding a static resource with a ZIP file.\nThat approach is not explored in this demo.")),(0,o.kt)("p",null,"Custom Code > Static Resources should now list ",(0,o.kt)("inlineCode",{parentName:"p"},"sheetjs"),":"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"/files/sfstatic.png",alt:"Static Resources"})),(0,o.kt)("h3",{id:"test-the-static-resource"},"Test the Static Resource"),(0,o.kt)("p",null,"The script can be loaded from component code with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import XLSX from '@salesforce/resourceUrl/sheetjs';\n")),(0,o.kt)("p",null,"The library includes a version number that can be displayed:"),(0,o.kt)("p",null,"1) Add a reference in ",(0,o.kt)("inlineCode",{parentName:"p"},"sheetComponent.js")," and expose the ",(0,o.kt)("inlineCode",{parentName:"p"},"version")," property:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { LightningElement } from 'lwc';\nimport { loadScript } from 'lightning/platformResourceLoader';\n// highlight-next-line\nimport sheetjs from '@salesforce/resourceUrl/sheetjs';\n\nexport default class SheetComponent extends LightningElement {\n  version = \"???\"; // start with ???\n  async connectedCallback() {\n    // highlight-next-line\n    await loadScript(this, sheetjs); // load the library\n    // At this point, the library is accessible with the `XLSX` variable\n    this.version = XLSX.version;\n  }\n}\n")),(0,o.kt)("p",null,"2) Reference the variable in ",(0,o.kt)("inlineCode",{parentName:"p"},"sheetComponent.html"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"<template>\n  \x3c!-- highlight-next-line --\x3e\n  <b>SheetForce {version}</b>\n</template>\n")),(0,o.kt)("p",null,'3) Deploy the project again and re-load the Bolt Solutions "SheetJS Demo" page:'),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"/files/sfversion.png",alt:"Version number"})),(0,o.kt)("h2",{id:"exporting-data-from-sf-lists"},"Exporting Data from SF Lists"),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"There are many different data types and APIs.  This demo uses the deprecated\n",(0,o.kt)("inlineCode",{parentName:"p"},"getListUi")," function to pull account data.")),(0,o.kt)("h3",{id:"steps"},"Steps"),(0,o.kt)("h4",{id:"getting-account-data"},"Getting Account Data"),(0,o.kt)("p",null,"The main method to obtain data is ",(0,o.kt)("inlineCode",{parentName:"p"},"getListUi")," and the key for account data is\n",(0,o.kt)("inlineCode",{parentName:"p"},"ACCOUNT_OBJECT"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { getListUi } from 'lightning/uiListApi';\nimport ACCOUNT_OBJECT from '@salesforce/schema/Account';\n\n// ...\n\nexport default class SheetComponent extends LightningElement {\n  @wire(getListUi, {\n    objectApiName: ACCOUNT_OBJECT.objectApiName,\n    listViewApiName: 'AllAccounts'\n  }) listInfo({ error, data }) {\n\n    // LIST DATA AVAILABLE HERE\n\n  };\n  // ...\n}\n")),(0,o.kt)("h4",{id:"generating-an-array-of-arrays"},"Generating an Array of Arrays"),(0,o.kt)("p",null,'SheetJS most reliably translates "arrays of arrays", a nested array which\ndirectly maps to individual cell addresses.  For example:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'var data = [\n  ["Name",      "Phone"],           // row 1\n  ["Foo Bar",   "(555) 555-5555"],  // row 2\n  ["Baz Qux",   "(555) 555-5556"]   // row 3\n];\n')),(0,o.kt)("p",null,"The APIs typically return nested objects, so the array must be constructed."),(0,o.kt)("details",null,(0,o.kt)("summary",null,(0,o.kt)("b",null,"Salesforce Representation")," (click to show)"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"data")," parameter in the callback has a deep structure. Typically one would\nset a property in the component and display data in a template:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"  // ...\n  // declare records variable in the component\n  records;\n  @wire(getListUi, {\n    objectApiName: ACCOUNT_OBJECT.objectApiName,\n    listViewApiName: 'AllAccounts'\n  }) listInfo({ error, data }) {\n    if (data) {\n      // data.records.records is the array of interest\n      this.records = data.records.records;\n      this.error = undefined;\n    }\n  }\n  // ...\n")),(0,o.kt)("p",null,"The template itself would iterate across the records:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<template>\n  <template if:true={records}>\n    <table>\n      <tr><th>Name</th><th>Phone</th></tr>\n      <template for:each={records} for:item="record">\n        <tr key={record.fields.Id.value}>\n          <td>{record.fields.Name.value}</td>\n          <td>{record.fields.Phone.value}</td>\n        </tr>\n      </template>\n    </table>\n  </template>\n</template>\n'))),(0,o.kt)("p",null,"A suitable SheetJS array of arrays can be constructed by mapping across records:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'      var headers = [ "Name", "Phone" ];\n      this.aoa = [headers].concat(data.records.records.map(record => [\n        record.fields.Name.value,  // Name field\n        record.fields.Phone.value, // Phone field\n      ]));\n')),(0,o.kt)("p",null,"This is readily exported to a spreadsheet in a callback function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'  @api async download() {\n    await loadScript(this, sheetjs); // load the library\n    // create workbook\n    var wb = XLSX.utils.book_new();\n    var ws = XLSX.utils.aoa_to_sheet(this.aoa);\n    XLSX.utils.book_append_sheet(wb, ws, "Data");\n    // export\n    XLSX.writeFile(wb, "SheetForceExport.xlsx");\n  };\n')),(0,o.kt)("h3",{id:"complete-example"},"Complete Example"),(0,o.kt)("p",null,"1) Add a button to ",(0,o.kt)("inlineCode",{parentName:"p"},"sheetComponent.html")," that will call a ",(0,o.kt)("inlineCode",{parentName:"p"},"download")," callback:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"<template>\n  \x3c!-- if the `aoa` property is set, show a button --\x3e\n  <template if:true={aoa}>\n    <button onclick={download}><b>Click to Export!</b></button>\n  </template>\n  \x3c!-- if the `aoa` property is not set, show a message --\x3e\n  <template if:false={aoa}><b>Please wait for data to load ...</b></template>\n</template>\n")),(0,o.kt)("p",null,"2) Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"sheetComponent.js")," with the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { LightningElement, wire, api } from 'lwc';\nimport { loadScript } from 'lightning/platformResourceLoader';\nimport { getListUi } from 'lightning/uiListApi';\nimport ACCOUNT_OBJECT from '@salesforce/schema/Account';\n\nimport sheetjs from '@salesforce/resourceUrl/sheetjs';\n\nexport default class SheetComponent extends LightningElement {\n  aoa; // will hold data for export\n  @wire(getListUi, {\n    objectApiName: ACCOUNT_OBJECT.objectApiName,\n    listViewApiName: 'AllAccounts'\n  }) listInfo({ error, data }) {\n    if (data) {\n      var headers = [ \"Name\", \"Phone\" ];\n      // create AOA and assign to `aoa` property\n      this.aoa = [headers].concat(data.records.records.map(record => [\n        record.fields.Name.value,  // Name field\n        record.fields.Phone.value, // Phone field\n      ]));\n    } else if (error) console.log(error);\n  };\n  @api async download() {\n    await loadScript(this, sheetjs); // load the library\n    // create workbook\n    var wb = XLSX.utils.book_new();\n    var ws = XLSX.utils.aoa_to_sheet(this.aoa);\n    XLSX.utils.book_append_sheet(wb, ws, \"Data\");\n    // export\n    XLSX.writeFile(wb, \"SheetForceExport.xlsx\");\n  };\n}\n")),(0,o.kt)("p",null,"3) Re-deploy and refresh the app page:"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"/files/sfexport.png",alt:"SF Export Button"})),(0,o.kt)("p",null,"The simple export has all of the data:"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"/files/sfxlexport.png",alt:"Excel Export"})),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("a",{parentName:"p",href:"https://sheetjs.com/pro"},"SheetJS Pro")," offers additional styling options like\ncell styling, automatic column width calculations, and frozen rows.")))}d.isMDXComponent=!0}}]);