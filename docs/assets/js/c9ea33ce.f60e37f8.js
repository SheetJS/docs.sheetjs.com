"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2700],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),c=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(i.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,h=d["".concat(i,".").concat(m)]||d[m]||p[m]||l;return n?r.createElement(h,o(o({ref:t},u),{},{components:n})):r.createElement(h,o({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,o=new Array(l);o[0]=d;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<l;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2360:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(7294),a=n(6010);const l="tabItem_OmH5";function o(e){let{children:t,hidden:n,className:o}=e;return r.createElement("div",{role:"tabpanel",className:(0,a.Z)(l,o),hidden:n},t)}},9877:(e,t,n)=>{n.d(t,{Z:()=>m});var r=n(7462),a=n(7294),l=n(2389),o=n(7392),s=n(7094),i=n(2466),c=n(6010);const u="tabList_uSqn",p="tabItem_LplD";function d(e){var t,n,l;const{lazy:d,block:m,defaultValue:h,values:b,groupId:f,className:v}=e,g=a.Children.map(e.children,(e=>{if((0,a.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),k=null!=b?b:g.map((e=>{let{props:{value:t,label:n,attributes:r}}=e;return{value:t,label:n,attributes:r}})),y=(0,o.l)(k,((e,t)=>e.value===t.value));if(y.length>0)throw new Error('Docusaurus error: Duplicate values "'+y.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.');const x=null===h?h:null!=(t=null!=h?h:null==(n=g.find((e=>e.props.default)))?void 0:n.props.value)?t:null==(l=g[0])?void 0:l.props.value;if(null!==x&&!k.some((e=>e.value===x)))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+x+'" but none of its children has the corresponding value. Available values are: '+k.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");const{tabGroupChoices:w,setTabGroupChoices:E}=(0,s.U)(),[O,T]=(0,a.useState)(x),N=[],{blockElementScrollPositionUntilNextRender:S}=(0,i.o5)();if(null!=f){const e=w[f];null!=e&&e!==O&&k.some((t=>t.value===e))&&T(e)}const j=e=>{const t=e.currentTarget,n=N.indexOf(t),r=k[n].value;r!==O&&(S(t),T(r),null!=f&&E(f,r))},P=e=>{var t;let n=null;switch(e.key){case"ArrowRight":{const t=N.indexOf(e.currentTarget)+1;n=N[t]||N[0];break}case"ArrowLeft":{const t=N.indexOf(e.currentTarget)-1;n=N[t]||N[N.length-1];break}}null==(t=n)||t.focus()};return a.createElement("div",{className:(0,c.Z)("tabs-container",u)},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,c.Z)("tabs",{"tabs--block":m},v)},k.map((e=>{let{value:t,label:n,attributes:l}=e;return a.createElement("li",(0,r.Z)({role:"tab",tabIndex:O===t?0:-1,"aria-selected":O===t,key:t,ref:e=>N.push(e),onKeyDown:P,onFocus:j,onClick:j},l,{className:(0,c.Z)("tabs__item",p,null==l?void 0:l.className,{"tabs__item--active":O===t})}),null!=n?n:t)}))),d?(0,a.cloneElement)(g.filter((e=>e.props.value===O))[0],{className:"margin-top--md"}):a.createElement("div",{className:"margin-top--md"},g.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==O})))))}function m(e){const t=(0,l.Z)();return a.createElement(d,(0,r.Z)({key:String(t)},e))}},9628:(e,t,n)=>{n.d(t,{Z:()=>r});const r="0.18.9"},589:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>u,toc:()=>d});var r=n(7462),a=(n(7294),n(3905)),l=n(9628),o=n(9877),s=n(2360);const i={sidebar_position:9,title:"Bundlers"},c=void 0,u={unversionedId:"getting-started/demos/bundler",id:"getting-started/demos/bundler",title:"Bundlers",description:"SheetJS predates ECMAScript modules and bundler tools like Webpack. As best",source:"@site/docs/04-getting-started/03-demos/09-bundler.md",sourceDirName:"04-getting-started/03-demos",slug:"/getting-started/demos/bundler",permalink:"/docs/getting-started/demos/bundler",draft:!1,tags:[],version:"current",sidebarPosition:9,frontMatter:{sidebar_position:9,title:"Bundlers"},sidebar:"tutorialSidebar",previous:{title:"Typed Arrays and ML",permalink:"/docs/getting-started/demos/ml"},next:{title:"Interface Summary",permalink:"/docs/interface"}},p={},d=[{value:"Parcel",id:"parcel",level:2}],m={toc:d};function h(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"SheetJS predates ECMAScript modules and bundler tools like Webpack. As best\npractices have evolved, stress testing SheetJS libraries have revealed bugs in\nthe respective bundlers.  This demo collects various notes and provides basic\nexamples. Issues should be reported to the respective bundler projects."),(0,a.kt)("h2",{id:"parcel"},"Parcel"),(0,a.kt)("p",null,"Parcel Bundler should play nice with SheetJS out of the box."),(0,a.kt)("p",null,"Errors of the form ",(0,a.kt)("inlineCode",{parentName:"p"},"Could not statically evaluate fs call")," stem from a\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/parcel-bundler/parcel/pull/523"},"parcel bug"),". Upgrade to\nParcel version 1.5.0 or later."),(0,a.kt)("details",null,(0,a.kt)("summary",null,(0,a.kt)("b",null,"Complete Example")," (click to show)"),(0,a.kt)("p",null,"This demo follows the ",(0,a.kt)("a",{parentName:"p",href:"../../example"},"Presidents Example"),"."),(0,a.kt)("p",null,"1) Save the following to ",(0,a.kt)("inlineCode",{parentName:"p"},"index.html"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html",metastring:'title="index.html"',title:'"index.html"'},'<body>\n<h3>SheetJS <span id="vers"></span> export demo</h3>\n<button id="xport">Click to Export!</button>\n\x3c!-- the script tag must be marked as `type="module"` --\x3e\n\x3c!-- highlight-next-line --\x3e\n<script type="module">\n// ESM-style import from "xlsx"\n// highlight-next-line\nimport { utils, version, writeFile } from \'xlsx\';\n\ndocument.getElementById("vers").innerText = version;\ndocument.getElementById("xport").onclick = async() => {\n  /* fetch JSON data and parse */\n  const url = "https://sheetjs.com/executive.json";\n  const raw_data = await (await fetch(url)).json();\n\n  /* filter for the Presidents */\n  const prez = raw_data.filter(row => row.terms.some(term => term.type === "prez"));\n\n  /* flatten objects */\n  const rows = prez.map(row => ({\n    name: row.name.first + " " + row.name.last,\n    birthday: row.bio.birthday\n  }));\n\n  /* generate worksheet and workbook */\n  const worksheet = utils.json_to_sheet(rows);\n  const workbook = utils.book_new();\n  utils.book_append_sheet(workbook, worksheet, "Dates");\n\n  /* fix headers */\n  utils.sheet_add_aoa(worksheet, [["Name", "Birthday"]], { origin: "A1" });\n\n  /* calculate column width */\n  const max_width = rows.reduce((w, r) => Math.max(w, r.name.length), 10);\n  worksheet["!cols"] = [ { wch: max_width } ];\n\n  /* create an XLSX file and try to save to Presidents.xlsx */\n  writeFile(workbook, "Presidents.xlsx");\n};\n<\/script>\n<body>\n')),(0,a.kt)("p",null,"2) Install the SheetJS node module:"),(0,a.kt)(o.Z,{mdxType:"Tabs"},(0,a.kt)(s.Z,{value:"npm",label:"npm",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ npm install --save https://cdn.sheetjs.com/xlsx-"+l.Z+"/xlsx-"+l.Z+".tgz"))),(0,a.kt)(s.Z,{value:"pnpm",label:"pnpm",mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ pnpm install --save https://cdn.sheetjs.com/xlsx-"+l.Z+"/xlsx-"+l.Z+".tgz"))),(0,a.kt)(s.Z,{value:"yarn",label:"Yarn",default:!0,mdxType:"TabItem"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ yarn add --save https://cdn.sheetjs.com/xlsx-"+l.Z+"/xlsx-"+l.Z+".tgz")))),(0,a.kt)("p",null,"3) Run the Parcel CLI tool:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"npx -y parcel index.html\n")),(0,a.kt)("p",null,"4) Access the page listed in the output (typically ",(0,a.kt)("inlineCode",{parentName:"p"},"http://localhost:1234"),') and\nclick the "Click to Export!" button to generate a file.')))}h.isMDXComponent=!0}}]);